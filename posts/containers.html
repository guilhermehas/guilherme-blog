<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Guilherme Silva Blog - Using Containers in Agda</title>
        <link rel="stylesheet" href="../css/default.css" />
        <link rel="stylesheet" href="Agda.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Guilherme Silva</a>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>Using Containers in Agda</h1>
            <article>
    <section class="header">
        Posted on July 19, 2021
        
            by Guilherme
        
    </section>
    <section>
        <h1 id="motivation">Motivation</h1>
<p>Containers are generic data structures that can represent most of the Agda data types. They enable one to prove properties of their data structure and also generate properties for them. With Agda reflection, it is possible to generate the container associated with the data structure and get the properties and associated structures for free (e.g. deriving a functor for the data types). <a href="https://github.com/effectfully/Generic">Agda Generic Library</a> does exactly that, it gets the data structure from reflection, transform it to containers, generate the equality for them and return the generated equality for the data structure.</p>
<h1 id="imports">Imports</h1>
<p>Importing agda standard library:</p>
<pre class="Agda"><a id="772" class="Keyword">module</a> <a id="779" href="containers.html" class="Module">containers</a> <a id="790" class="Keyword">where</a>

<a id="797" class="Keyword">open</a> <a id="802" class="Keyword">import</a> <a id="809" href="internal-library.html" class="Module">internal-library</a>
<a id="826" class="Keyword">open</a> <a id="831" class="Keyword">import</a> <a id="838" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="860" class="Keyword">open</a> <a id="865" class="Keyword">import</a> <a id="872" href="Level.html" class="Module">Level</a> <a id="878" class="Keyword">renaming</a> <a id="887" class="Symbol">(</a><a id="888" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="893" class="Symbol">to</a> <a id="896" class="Primitive">lzero</a><a id="901" class="Symbol">;</a> <a id="903" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="907" class="Symbol">to</a> <a id="910" class="Primitive">lsuc</a><a id="914" class="Symbol">)</a>
<a id="916" class="Keyword">import</a> <a id="923" href="Function.html" class="Module">Function</a> <a id="932" class="Symbol">as</a> <a id="935" class="Module">F</a>

<a id="938" class="Keyword">open</a> <a id="943" class="Keyword">import</a> <a id="950" href="Data.Container.html" class="Module">Data.Container</a> <a id="965" class="Keyword">hiding</a> <a id="972" class="Symbol">(</a><a id="973" href="Data.Container.Relation.Binary.Pointwise.Properties.html#732" class="Function">refl</a><a id="977" class="Symbol">)</a>
<a id="979" class="Keyword">open</a> <a id="984" class="Keyword">import</a> <a id="991" href="Data.Container.Combinator.html" class="Module">Data.Container.Combinator</a>
<a id="1017" class="Keyword">open</a> <a id="1022" class="Keyword">import</a> <a id="1029" href="Data.W.html" class="Module">Data.W</a> <a id="1036" class="Keyword">hiding</a> <a id="1043" class="Symbol">(</a><a id="1044" href="Data.W.html#1150" class="Function">map</a><a id="1047" class="Symbol">)</a>
<a id="1049" class="Keyword">open</a> <a id="1054" class="Keyword">import</a> <a id="1061" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="1071" class="Keyword">open</a> <a id="1076" class="Keyword">import</a> <a id="1083" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="1094" class="Keyword">open</a> <a id="1099" class="Keyword">import</a> <a id="1106" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="1116" class="Keyword">open</a> <a id="1121" class="Keyword">import</a> <a id="1128" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1139" class="Keyword">hiding</a> <a id="1146" class="Symbol">(</a><a id="1147" href="Data.Maybe.Base.html#2020" class="Function">map</a><a id="1150" class="Symbol">)</a>
<a id="1152" class="Keyword">open</a> <a id="1157" class="Keyword">import</a> <a id="1164" href="Data.Product.html" class="Module">Data.Product</a> <a id="1177" class="Keyword">using</a> <a id="1183" class="Symbol">(</a><a id="1184" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="1187" class="Symbol">;</a> <a id="1189" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="1194" class="Symbol">;</a> <a id="1196" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="1201" class="Symbol">)</a>
<a id="1203" class="Keyword">open</a> <a id="1208" class="Keyword">import</a> <a id="1215" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="1224" class="Keyword">hiding</a> <a id="1231" class="Symbol">(</a><a id="1232" href="Data.Sum.Base.html#1362" class="Function">map</a><a id="1235" class="Symbol">)</a>
<a id="1237" class="Keyword">open</a> <a id="1242" class="Keyword">import</a> <a id="1249" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="1258" class="Keyword">open</a> <a id="1263" class="Keyword">import</a> <a id="1270" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="1279" class="Keyword">renaming</a> <a id="1288" class="Symbol">(</a><a id="1289" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a> <a id="1294" class="Symbol">to</a> <a id="1297" class="InductiveConstructor">fzero</a><a id="1302" class="Symbol">;</a> <a id="1304" href="Data.Fin.Base.html#1179" class="InductiveConstructor">suc</a> <a id="1308" class="Symbol">to</a> <a id="1311" class="InductiveConstructor">fsuc</a><a id="1315" class="Symbol">)</a> <a id="1317" class="Keyword">hiding</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Data.Fin.Base.html#5404" class="Function Operator">_+_</a><a id="1328" class="Symbol">)</a>
</pre>
<h1 id="definition">Definition</h1>
<p>The container is a record with two fields: Shape and Position. The shape is its shape type and the position reference each shape for a type.</p>
<h2 id="two-container">Two Container</h2>
<p>One of the simplest containers is a container with just two elements (the same as Bool).</p>
<pre class="Agda"><a id="1603" class="Keyword">module</a> <a id="TwoContainer"></a><a id="1610" href="containers.html#1610" class="Module">TwoContainer</a> <a id="1623" class="Keyword">where</a>
  <a id="TwoContainer.Two"></a><a id="1631" href="containers.html#1631" class="Function">Two</a> <a id="1635" class="Symbol">:</a> <a id="1637" href="Data.Container.Core.html#558" class="Record">Container</a> <a id="1647" href="containers.html#896" class="Primitive">lzero</a> <a id="1653" href="containers.html#896" class="Primitive">lzero</a>
  <a id="1661" href="containers.html#1631" class="Function">Two</a> <a id="1665" class="Symbol">=</a> <a id="1667" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a> <a id="1669" href="Data.Container.Core.html#622" class="InductiveConstructor Operator">▷</a> <a id="1671" href="Function.Base.html#636" class="Function">F.const</a> <a id="1679" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
</pre>
<p>In this example, the shape is the Unit type (the set with just one element) and it has 2 positions.</p>
<p>Now, it is time to interpret this container:</p>
<pre class="Agda">  <a id="TwoContainer.Double'"></a><a id="1842" href="containers.html#1842" class="Function">Double'</a> <a id="1850" class="Symbol">:</a> <a id="1852" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1856" class="Symbol">→</a> <a id="1858" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="1864" href="containers.html#1842" class="Function">Double'</a> <a id="1872" class="Symbol">=</a> <a id="1874" href="Data.Container.Core.html#755" class="Function Operator">⟦</a> <a id="1876" href="containers.html#1631" class="Function">Two</a> <a id="1880" href="Data.Container.Core.html#755" class="Function Operator">⟧</a>
</pre>
<p>And to add their constructors and destructors:</p>
<pre class="Agda">  <a id="TwoContainer.mkDouble'"></a><a id="1941" href="containers.html#1941" class="Function">mkDouble'</a> <a id="1951" class="Symbol">:</a> <a id="1953" class="Symbol">∀</a> <a id="1955" class="Symbol">{</a><a id="1956" href="containers.html#1956" class="Bound">A</a><a id="1957" class="Symbol">}</a> <a id="1959" class="Symbol">→</a> <a id="1961" class="Symbol">(</a><a id="1962" href="containers.html#1962" class="Bound">x</a> <a id="1964" href="containers.html#1964" class="Bound">y</a> <a id="1966" class="Symbol">:</a> <a id="1968" href="containers.html#1956" class="Bound">A</a><a id="1969" class="Symbol">)</a> <a id="1971" class="Symbol">→</a> <a id="1973" href="containers.html#1842" class="Function">Double'</a> <a id="1981" href="containers.html#1956" class="Bound">A</a>
  <a id="1985" href="containers.html#1941" class="Function">mkDouble'</a> <a id="1995" href="containers.html#1995" class="Bound">x</a> <a id="1997" href="containers.html#1997" class="Bound">y</a> <a id="1999" class="Symbol">.</a><a id="2000" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="2006" class="Symbol">=</a> <a id="2008" class="Symbol">_</a>
  <a id="2012" href="containers.html#1941" class="Function">mkDouble'</a> <a id="2022" href="containers.html#2022" class="Bound">x</a> <a id="2024" href="containers.html#2024" class="Bound">y</a> <a id="2026" class="Symbol">.</a><a id="2027" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="2033" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="2039" class="Symbol">=</a> <a id="2041" href="containers.html#2022" class="Bound">x</a>
  <a id="2045" href="containers.html#1941" class="Function">mkDouble'</a> <a id="2055" href="containers.html#2055" class="Bound">x</a> <a id="2057" href="containers.html#2057" class="Bound">y</a> <a id="2059" class="Symbol">.</a><a id="2060" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="2066" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2072" class="Symbol">=</a> <a id="2074" href="containers.html#2057" class="Bound">y</a>

  <a id="TwoContainer.proj1"></a><a id="2079" href="containers.html#2079" class="Function">proj1</a> <a id="2085" class="Symbol">:</a> <a id="2087" class="Symbol">∀</a> <a id="2089" class="Symbol">{</a><a id="2090" href="containers.html#2090" class="Bound">A</a><a id="2091" class="Symbol">}</a> <a id="2093" class="Symbol">→</a> <a id="2095" href="containers.html#1842" class="Function">Double'</a> <a id="2103" href="containers.html#2090" class="Bound">A</a> <a id="2105" class="Symbol">→</a> <a id="2107" href="containers.html#2090" class="Bound">A</a>
  <a id="2111" href="containers.html#2079" class="Function">proj1</a> <a id="2117" class="Symbol">(_</a> <a id="2120" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2122" href="containers.html#2122" class="Bound">p</a><a id="2123" class="Symbol">)</a> <a id="2125" class="Symbol">=</a> <a id="2127" href="containers.html#2122" class="Bound">p</a> <a id="2129" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

  <a id="TwoContainer.proj2"></a><a id="2137" href="containers.html#2137" class="Function">proj2</a> <a id="2143" class="Symbol">:</a> <a id="2145" class="Symbol">∀</a> <a id="2147" class="Symbol">{</a><a id="2148" href="containers.html#2148" class="Bound">A</a><a id="2149" class="Symbol">}</a> <a id="2151" class="Symbol">→</a> <a id="2153" href="containers.html#1842" class="Function">Double'</a> <a id="2161" href="containers.html#2148" class="Bound">A</a> <a id="2163" class="Symbol">→</a> <a id="2165" href="containers.html#2148" class="Bound">A</a>
  <a id="2169" href="containers.html#2137" class="Function">proj2</a> <a id="2175" class="Symbol">(_</a> <a id="2178" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2180" href="containers.html#2180" class="Bound">p</a><a id="2181" class="Symbol">)</a> <a id="2183" class="Symbol">=</a> <a id="2185" href="containers.html#2180" class="Bound">p</a> <a id="2187" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
</pre>
<p>To test them, I created a tuple that the first element is false and the second is true.</p>
<pre class="Agda">  <a id="TwoContainer.myTuple"></a><a id="2293" href="containers.html#2293" class="Function">myTuple</a> <a id="2301" class="Symbol">=</a> <a id="2303" href="containers.html#1941" class="Function">mkDouble'</a> <a id="2313" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2319" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
</pre>
<p>When containers really shine is when we get type classes and properties of them for free. All containers have a functor. So, I will invert the elements of that tuple with <code>map</code> that I got from its functor.</p>
<pre class="Agda">  <a id="TwoContainer.inverted"></a><a id="2542" href="containers.html#2542" class="Function">inverted</a> <a id="2551" class="Symbol">=</a> <a id="2553" href="Data.Container.Core.html#880" class="Function">map</a> <a id="2557" href="Data.Bool.Base.html#932" class="Function">not</a> <a id="2561" href="containers.html#2293" class="Function">myTuple</a>

  <a id="2572" href="containers.html#2572" class="Function">_</a> <a id="2574" class="Symbol">:</a> <a id="2576" href="containers.html#2079" class="Function">proj1</a> <a id="2582" href="containers.html#2542" class="Function">inverted</a> <a id="2591" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2593" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
  <a id="2600" class="Symbol">_</a> <a id="2602" class="Symbol">=</a> <a id="2604" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2612" href="containers.html#2612" class="Function">_</a> <a id="2614" class="Symbol">:</a> <a id="2616" href="containers.html#2137" class="Function">proj2</a> <a id="2622" href="containers.html#2542" class="Function">inverted</a> <a id="2631" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2633" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
  <a id="2641" class="Symbol">_</a> <a id="2643" class="Symbol">=</a> <a id="2645" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
<h2 id="two-container-with-product-constructor">Two Container with product constructor</h2>
<p>Another way of defining a set with two elements is to define it as a product of two sets of one element.</p>
<pre class="Agda"><a id="2808" class="Keyword">module</a> <a id="2815" href="containers.html#2815" class="Module">_</a> <a id="2817" class="Keyword">where</a>
  <a id="2825" href="containers.html#2825" class="Function">Two</a> <a id="2829" class="Symbol">:</a> <a id="2831" href="Data.Container.Core.html#558" class="Record">Container</a> <a id="2841" href="containers.html#896" class="Primitive">lzero</a> <a id="2847" href="containers.html#896" class="Primitive">lzero</a>
  <a id="2855" href="containers.html#2825" class="Function">Two</a> <a id="2859" class="Symbol">=</a> <a id="2861" href="Data.Container.Combinator.html#753" class="Function">id</a> <a id="2864" href="Data.Container.Combinator.html#1241" class="Function Operator">×</a> <a id="2866" href="Data.Container.Combinator.html#753" class="Function">id</a>
</pre>
<p>The rest is almost the same:</p>
<pre class="Agda">  <a id="2910" href="containers.html#2910" class="Function">Double'</a> <a id="2918" class="Symbol">:</a> <a id="2920" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2924" class="Symbol">→</a> <a id="2926" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2932" href="containers.html#2910" class="Function">Double'</a> <a id="2940" class="Symbol">=</a> <a id="2942" href="Data.Container.Core.html#755" class="Function Operator">⟦</a> <a id="2944" href="containers.html#2825" class="Function">Two</a> <a id="2948" href="Data.Container.Core.html#755" class="Function Operator">⟧</a>

  <a id="2953" href="containers.html#2953" class="Function">mkDouble'</a> <a id="2963" class="Symbol">:</a> <a id="2965" class="Symbol">∀</a> <a id="2967" class="Symbol">{</a><a id="2968" href="containers.html#2968" class="Bound">A</a><a id="2969" class="Symbol">}</a> <a id="2971" class="Symbol">→</a> <a id="2973" class="Symbol">(</a><a id="2974" href="containers.html#2974" class="Bound">x</a> <a id="2976" href="containers.html#2976" class="Bound">y</a> <a id="2978" class="Symbol">:</a> <a id="2980" href="containers.html#2968" class="Bound">A</a><a id="2981" class="Symbol">)</a> <a id="2983" class="Symbol">→</a> <a id="2985" href="containers.html#2910" class="Function">Double'</a> <a id="2993" href="containers.html#2968" class="Bound">A</a>
  <a id="2997" href="containers.html#2953" class="Function">mkDouble'</a> <a id="3007" href="containers.html#3007" class="Bound">x</a> <a id="3009" href="containers.html#3009" class="Bound">y</a> <a id="3011" class="Symbol">=</a> <a id="3013" class="Symbol">_</a> <a id="3015" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3017" href="Data.Sum.Base.html#920" class="Function Operator">[</a> <a id="3019" href="Function.Base.html#636" class="Function">F.const</a> <a id="3027" href="containers.html#3007" class="Bound">x</a> <a id="3029" href="Data.Sum.Base.html#920" class="Function Operator">,</a> <a id="3031" href="Function.Base.html#636" class="Function">F.const</a> <a id="3039" href="containers.html#3009" class="Bound">y</a> <a id="3041" href="Data.Sum.Base.html#920" class="Function Operator">]</a>

  <a id="3046" href="containers.html#3046" class="Function">proj1</a> <a id="3052" class="Symbol">:</a> <a id="3054" class="Symbol">∀</a> <a id="3056" class="Symbol">{</a><a id="3057" href="containers.html#3057" class="Bound">A</a><a id="3058" class="Symbol">}</a> <a id="3060" class="Symbol">→</a> <a id="3062" href="containers.html#2910" class="Function">Double'</a> <a id="3070" href="containers.html#3057" class="Bound">A</a> <a id="3072" class="Symbol">→</a> <a id="3074" href="containers.html#3057" class="Bound">A</a>
  <a id="3078" href="containers.html#3046" class="Function">proj1</a> <a id="3084" class="Symbol">(_</a> <a id="3087" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3089" href="containers.html#3089" class="Bound">p</a><a id="3090" class="Symbol">)</a> <a id="3092" class="Symbol">=</a> <a id="3094" href="containers.html#3089" class="Bound">p</a> <a id="3096" class="Symbol">(</a><a id="3097" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="3102" class="Symbol">_)</a>

  <a id="3108" href="containers.html#3108" class="Function">proj2</a> <a id="3114" class="Symbol">:</a> <a id="3116" class="Symbol">∀</a> <a id="3118" class="Symbol">{</a><a id="3119" href="containers.html#3119" class="Bound">A</a><a id="3120" class="Symbol">}</a> <a id="3122" class="Symbol">→</a> <a id="3124" href="containers.html#2910" class="Function">Double'</a> <a id="3132" href="containers.html#3119" class="Bound">A</a> <a id="3134" class="Symbol">→</a> <a id="3136" href="containers.html#3119" class="Bound">A</a>
  <a id="3140" href="containers.html#3108" class="Function">proj2</a> <a id="3146" class="Symbol">(_</a> <a id="3149" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3151" href="containers.html#3151" class="Bound">p</a><a id="3152" class="Symbol">)</a> <a id="3154" class="Symbol">=</a> <a id="3156" href="containers.html#3151" class="Bound">p</a> <a id="3158" class="Symbol">(</a><a id="3159" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="3164" class="Symbol">_)</a>

  <a id="3170" href="containers.html#3170" class="Function">myTuple</a> <a id="3178" class="Symbol">=</a> <a id="3180" href="containers.html#2953" class="Function">mkDouble'</a> <a id="3190" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="3196" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
  <a id="3203" href="containers.html#3203" class="Function">inverted</a> <a id="3212" class="Symbol">=</a> <a id="3214" href="Data.Container.Core.html#880" class="Function">map</a> <a id="3218" href="Data.Bool.Base.html#932" class="Function">not</a> <a id="3222" href="containers.html#3170" class="Function">myTuple</a>

  <a id="3233" href="containers.html#3233" class="Function">_</a> <a id="3235" class="Symbol">:</a> <a id="3237" href="containers.html#3046" class="Function">proj1</a> <a id="3243" href="containers.html#3203" class="Function">inverted</a> <a id="3252" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3254" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
  <a id="3261" class="Symbol">_</a> <a id="3263" class="Symbol">=</a> <a id="3265" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="3273" href="containers.html#3273" class="Function">_</a> <a id="3275" class="Symbol">:</a> <a id="3277" href="containers.html#3108" class="Function">proj2</a> <a id="3283" href="containers.html#3203" class="Function">inverted</a> <a id="3292" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3294" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
  <a id="3302" class="Symbol">_</a> <a id="3304" class="Symbol">=</a> <a id="3306" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
<h2 id="list-container">List Container</h2>
<p>In the list container, the shape is the natural number. So each natural number corresponds to a list of its size. In the list, the position of each element is between 0 and its size. So the position is <code>Fin (length list)</code>.</p>
<pre class="Agda"><a id="ListC"></a><a id="3563" href="containers.html#3563" class="Function">ListC</a> <a id="3569" class="Symbol">:</a> <a id="3571" href="Data.Container.Core.html#558" class="Record">Container</a> <a id="3581" href="containers.html#896" class="Primitive">lzero</a> <a id="3587" href="containers.html#896" class="Primitive">lzero</a>
<a id="3593" href="containers.html#3563" class="Function">ListC</a> <a id="3599" class="Symbol">=</a> <a id="3601" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3603" href="Data.Container.Core.html#622" class="InductiveConstructor Operator">▷</a> <a id="3605" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a>
</pre>
<p>Interpreting the list:</p>
<pre class="Agda"><a id="List"></a><a id="3642" href="containers.html#3642" class="Function">List</a> <a id="3647" class="Symbol">:</a> <a id="3649" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3653" class="Symbol">→</a> <a id="3655" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="3659" href="containers.html#3642" class="Function">List</a> <a id="3664" class="Symbol">=</a> <a id="3666" href="Data.Container.Core.html#755" class="Function Operator">⟦</a> <a id="3668" href="containers.html#3563" class="Function">ListC</a> <a id="3674" href="Data.Container.Core.html#755" class="Function Operator">⟧</a>
</pre>
<p>Getting their constructors and destructors:</p>
<pre class="Agda"><a id="[]"></a><a id="3730" href="containers.html#3730" class="Function">[]</a> <a id="3733" class="Symbol">:</a> <a id="3735" class="Symbol">{</a><a id="3736" href="containers.html#3736" class="Bound">A</a> <a id="3738" class="Symbol">:</a> <a id="3740" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="3743" class="Symbol">}</a> <a id="3745" class="Symbol">→</a> <a id="3747" href="containers.html#3642" class="Function">List</a> <a id="3752" href="containers.html#3736" class="Bound">A</a>
<a id="3754" href="containers.html#3730" class="Function">[]</a> <a id="3757" class="Symbol">=</a> <a id="3759" class="Number">0</a> <a id="3761" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3763" class="Symbol">λ</a> <a id="3765" class="Symbol">()</a>

<a id="3769" class="Keyword">infixr</a> <a id="3776" class="Number">5</a> <a id="3778" href="containers.html#3782" class="Function Operator">_∷_</a>
<a id="_∷_"></a><a id="3782" href="containers.html#3782" class="Function Operator">_∷_</a> <a id="3786" class="Symbol">:</a> <a id="3788" class="Symbol">{</a><a id="3789" href="containers.html#3789" class="Bound">A</a> <a id="3791" class="Symbol">:</a> <a id="3793" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="3796" class="Symbol">}</a> <a id="3798" class="Symbol">→</a> <a id="3800" href="containers.html#3789" class="Bound">A</a> <a id="3802" class="Symbol">→</a> <a id="3804" href="containers.html#3642" class="Function">List</a> <a id="3809" href="containers.html#3789" class="Bound">A</a> <a id="3811" class="Symbol">→</a> <a id="3813" href="containers.html#3642" class="Function">List</a> <a id="3818" href="containers.html#3789" class="Bound">A</a>
<a id="3820" class="Symbol">(</a><a id="3821" href="containers.html#3821" class="Bound">x</a> <a id="3823" href="containers.html#3782" class="Function Operator">∷</a> <a id="3825" class="Symbol">(</a><a id="3826" href="containers.html#3826" class="Bound">size</a> <a id="3831" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3833" href="containers.html#3833" class="Bound">fxs</a><a id="3836" class="Symbol">))</a> <a id="3839" class="Symbol">.</a><a id="3840" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>           <a id="3856" class="Symbol">=</a> <a id="3858" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3862" href="containers.html#3826" class="Bound">size</a>
<a id="3867" class="Symbol">(</a><a id="3868" href="containers.html#3868" class="Bound">x</a> <a id="3870" href="containers.html#3782" class="Function Operator">∷</a> <a id="3872" class="Symbol">(</a><a id="3873" href="containers.html#3873" class="Bound">size</a> <a id="3878" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3880" href="containers.html#3880" class="Bound">fxs</a><a id="3883" class="Symbol">))</a> <a id="3886" class="Symbol">.</a><a id="3887" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3893" href="containers.html#1297" class="InductiveConstructor">fzero</a>     <a id="3903" class="Symbol">=</a> <a id="3905" href="containers.html#3868" class="Bound">x</a>
<a id="3907" class="Symbol">(</a><a id="3908" href="containers.html#3908" class="Bound">x</a> <a id="3910" href="containers.html#3782" class="Function Operator">∷</a> <a id="3912" class="Symbol">(</a><a id="3913" href="containers.html#3913" class="Bound">size</a> <a id="3918" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3920" href="containers.html#3920" class="Bound">fxs</a><a id="3923" class="Symbol">))</a> <a id="3926" class="Symbol">.</a><a id="3927" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3933" class="Symbol">(</a><a id="3934" href="containers.html#1311" class="InductiveConstructor">fsuc</a> <a id="3939" href="containers.html#3939" class="Bound">xs</a><a id="3941" class="Symbol">)</a> <a id="3943" class="Symbol">=</a> <a id="3945" href="containers.html#3920" class="Bound">fxs</a> <a id="3949" href="containers.html#3939" class="Bound">xs</a>

<a id="head'"></a><a id="3953" href="containers.html#3953" class="Function">head'</a> <a id="3959" class="Symbol">:</a> <a id="3961" class="Symbol">{</a><a id="3962" href="containers.html#3962" class="Bound">A</a> <a id="3964" class="Symbol">:</a> <a id="3966" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="3969" class="Symbol">}</a> <a id="3971" class="Symbol">→</a> <a id="3973" href="containers.html#3642" class="Function">List</a> <a id="3978" href="containers.html#3962" class="Bound">A</a> <a id="3980" class="Symbol">→</a> <a id="3982" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3988" href="containers.html#3962" class="Bound">A</a>
<a id="3990" href="containers.html#3953" class="Function">head'</a> <a id="3996" class="Symbol">(</a><a id="3997" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="4002" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4004" class="Symbol">_)</a>    <a id="4010" class="Symbol">=</a> <a id="4012" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="4020" href="containers.html#3953" class="Function">head'</a> <a id="4026" class="Symbol">(</a><a id="4027" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4031" href="containers.html#4031" class="Bound">n</a> <a id="4033" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4035" href="containers.html#4035" class="Bound">fxs</a><a id="4038" class="Symbol">)</a> <a id="4040" class="Symbol">=</a> <a id="4042" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4047" class="Symbol">(</a><a id="4048" href="containers.html#4035" class="Bound">fxs</a> <a id="4052" href="containers.html#1297" class="InductiveConstructor">fzero</a><a id="4057" class="Symbol">)</a>

<a id="tail'"></a><a id="4060" href="containers.html#4060" class="Function">tail'</a> <a id="4066" class="Symbol">:</a> <a id="4068" class="Symbol">{</a><a id="4069" href="containers.html#4069" class="Bound">A</a> <a id="4071" class="Symbol">:</a> <a id="4073" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4076" class="Symbol">}</a> <a id="4078" class="Symbol">→</a> <a id="4080" href="containers.html#3642" class="Function">List</a> <a id="4085" href="containers.html#4069" class="Bound">A</a> <a id="4087" class="Symbol">→</a> <a id="4089" href="containers.html#3642" class="Function">List</a> <a id="4094" href="containers.html#4069" class="Bound">A</a>
<a id="4096" href="containers.html#4060" class="Function">tail'</a> <a id="4102" class="Symbol">(</a><a id="4103" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="4108" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a>    <a id="4113" class="Symbol">_)</a> <a id="4116" class="Symbol">=</a> <a id="4118" class="Number">0</a> <a id="4120" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4122" class="Symbol">λ</a> <a id="4124" class="Symbol">()</a>
<a id="4127" href="containers.html#4060" class="Function">tail'</a> <a id="4133" class="Symbol">(</a><a id="4134" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4138" href="containers.html#4138" class="Bound">n</a> <a id="4140" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4142" href="containers.html#4142" class="Bound">fxs</a><a id="4145" class="Symbol">)</a> <a id="4147" class="Symbol">=</a> <a id="4149" href="containers.html#4138" class="Bound">n</a> <a id="4151" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4153" href="containers.html#4142" class="Bound">fxs</a> <a id="4157" href="Function.Base.html#1031" class="Function Operator">F.∘</a> <a id="4161" href="containers.html#1311" class="InductiveConstructor">fsuc</a>
</pre>
<p>The list got the Functor type class for free. So I will show in this example how to use them:</p>
<pre class="Agda"><a id="list"></a><a id="4270" href="containers.html#4270" class="Function">list</a> <a id="4275" class="Symbol">:</a> <a id="4277" href="containers.html#3642" class="Function">List</a> <a id="4282" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="4284" href="containers.html#4270" class="Function">list</a> <a id="4289" class="Symbol">=</a> <a id="4291" class="Number">0</a> <a id="4293" href="containers.html#3782" class="Function Operator">∷</a> <a id="4295" class="Number">1</a> <a id="4297" href="containers.html#3782" class="Function Operator">∷</a> <a id="4299" class="Number">2</a> <a id="4301" href="containers.html#3782" class="Function Operator">∷</a> <a id="4303" href="containers.html#3730" class="Function">[]</a>

<a id="listM"></a><a id="4307" href="containers.html#4307" class="Function">listM</a> <a id="4313" class="Symbol">=</a> <a id="4315" href="Data.Container.Core.html#880" class="Function">map</a> <a id="4319" class="Symbol">(</a><a id="4320" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="4323" class="Number">10</a><a id="4325" class="Symbol">)</a> <a id="4327" href="containers.html#4270" class="Function">list</a>

<a id="4333" href="containers.html#4333" class="Function">_</a> <a id="4335" class="Symbol">:</a> <a id="4337" href="containers.html#3953" class="Function">head'</a> <a id="4343" class="Symbol">(</a><a id="4344" href="containers.html#4060" class="Function">tail'</a> <a id="4350" href="containers.html#4307" class="Function">listM</a><a id="4355" class="Symbol">)</a> <a id="4357" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4359" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4364" class="Number">11</a>
<a id="4367" class="Symbol">_</a> <a id="4369" class="Symbol">=</a> <a id="4371" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
<h1 id="function-container">Function container</h1>
<p>The function container is made using <code>const[_]⟶_</code> of the library that has this property: <code>⟦ const[ I ]⟶ id ⟧ X ↔︎ (I → ⟦ id ⟧ X) ↔︎ (I → F.id X) ↔︎ (I → X)</code>.</p>
<pre class="Agda"><a id="4564" class="Keyword">module</a> <a id="4571" href="containers.html#4571" class="Module">_</a> <a id="4573" class="Symbol">(</a><a id="4574" href="containers.html#4574" class="Bound">A</a> <a id="4576" class="Symbol">:</a> <a id="4578" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4581" class="Symbol">)</a> <a id="4583" class="Keyword">where</a>
  <a id="4591" href="containers.html#4591" class="Function">ContainerF</a> <a id="4602" class="Symbol">:</a> <a id="4604" href="Data.Container.Core.html#558" class="Record">Container</a> <a id="4614" href="containers.html#896" class="Primitive">lzero</a> <a id="4620" href="containers.html#896" class="Primitive">lzero</a>
  <a id="4628" href="containers.html#4591" class="Function">ContainerF</a> <a id="4639" class="Symbol">=</a> <a id="4641" href="Data.Container.Combinator.html#1756" class="Function Operator">const[</a> <a id="4648" href="containers.html#4574" class="Bound">A</a> <a id="4650" href="Data.Container.Combinator.html#1756" class="Function Operator">]⟶</a> <a id="4653" href="Data.Container.Combinator.html#753" class="Function">id</a>
</pre>
Interpreting it:
<pre class="Agda">  <a id="4684" href="containers.html#4684" class="Function">A→B'</a> <a id="4689" class="Symbol">:</a> <a id="4691" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4695" class="Symbol">→</a> <a id="4697" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="4703" href="containers.html#4684" class="Function">A→B'</a> <a id="4708" class="Symbol">=</a> <a id="4710" href="Data.Container.Core.html#755" class="Function Operator">⟦</a> <a id="4712" href="containers.html#4591" class="Function">ContainerF</a> <a id="4723" href="Data.Container.Core.html#755" class="Function Operator">⟧</a>
</pre>
Defining constructors and destructors:
<pre class="Agda"><a id="4773" class="Keyword">module</a> <a id="4780" href="containers.html#4780" class="Module">_</a> <a id="4782" class="Symbol">{</a><a id="4783" href="containers.html#4783" class="Bound">A</a> <a id="4785" href="containers.html#4785" class="Bound">B</a> <a id="4787" class="Symbol">:</a> <a id="4789" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4792" class="Symbol">}</a> <a id="4794" class="Keyword">where</a>
  <a id="4802" href="containers.html#4802" class="Function">A→B</a> <a id="4806" class="Symbol">=</a> <a id="4808" href="containers.html#4684" class="Function">A→B'</a> <a id="4813" href="containers.html#4783" class="Bound">A</a> <a id="4815" href="containers.html#4785" class="Bound">B</a>

  <a id="4820" href="containers.html#4820" class="Function Operator">_∘'_</a> <a id="4825" class="Symbol">:</a> <a id="4827" href="containers.html#4802" class="Function">A→B</a> <a id="4831" class="Symbol">→</a> <a id="4833" href="containers.html#4783" class="Bound">A</a> <a id="4835" class="Symbol">→</a> <a id="4837" href="containers.html#4785" class="Bound">B</a>
  <a id="4841" class="Symbol">(_</a> <a id="4844" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4846" href="containers.html#4846" class="Bound">f</a><a id="4847" class="Symbol">)</a> <a id="4849" href="containers.html#4820" class="Function Operator">∘'</a> <a id="4852" href="containers.html#4852" class="Bound">a</a> <a id="4854" class="Symbol">=</a> <a id="4856" href="containers.html#4846" class="Bound">f</a> <a id="4858" class="Symbol">(</a><a id="4859" href="containers.html#4852" class="Bound">a</a> <a id="4861" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4863" class="Symbol">_)</a>

  <a id="4869" href="containers.html#4869" class="Function">intro</a> <a id="4875" class="Symbol">:</a> <a id="4877" class="Symbol">(</a><a id="4878" href="containers.html#4783" class="Bound">A</a> <a id="4880" class="Symbol">→</a> <a id="4882" href="containers.html#4785" class="Bound">B</a><a id="4883" class="Symbol">)</a> <a id="4885" class="Symbol">→</a> <a id="4887" href="containers.html#4802" class="Function">A→B</a>
  <a id="4893" href="containers.html#4869" class="Function">intro</a> <a id="4899" href="containers.html#4899" class="Bound">f</a> <a id="4901" class="Symbol">=</a> <a id="4903" class="Symbol">_</a> <a id="4905" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4907" href="containers.html#4899" class="Bound">f</a> <a id="4909" href="Function.Base.html#1031" class="Function Operator">F.∘</a> <a id="4913" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
</pre>
<p>Using them with the functor that we got for free:</p>
<pre class="Agda"><a id="4979" href="containers.html#4979" class="Function">_</a> <a id="4981" class="Symbol">:</a> <a id="4983" href="Data.Container.Core.html#880" class="Function">map</a> <a id="4987" class="Symbol">(</a><a id="4988" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="4991" class="Number">10</a><a id="4993" class="Symbol">)</a> <a id="4995" class="Symbol">(</a><a id="4996" href="containers.html#4869" class="Function">intro</a> <a id="5002" class="Symbol">(</a><a id="5003" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+</a> <a id="5006" class="Number">1</a><a id="5007" class="Symbol">))</a> <a id="5010" href="containers.html#4820" class="Function Operator">∘'</a> <a id="5013" class="Number">0</a> <a id="5015" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5017" class="Number">11</a>
<a id="5020" class="Symbol">_</a> <a id="5022" class="Symbol">=</a> <a id="5024" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
<h1 id="fixpoints">Fixpoints</h1>
<p>It is also possible to use fixpoints in containers too and the best example is defining natural numbers with them:</p>
<pre class="Agda"><a id="NatCC"></a><a id="5167" href="containers.html#5167" class="Function">NatCC</a> <a id="5173" class="Symbol">:</a> <a id="5175" href="Data.Container.Core.html#558" class="Record">Container</a> <a id="5185" href="containers.html#896" class="Primitive">lzero</a> <a id="5191" href="containers.html#896" class="Primitive">lzero</a>
<a id="5197" href="containers.html#5167" class="Function">NatCC</a> <a id="5203" class="Symbol">=</a> <a id="5205" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="5210" href="Data.Container.Core.html#622" class="InductiveConstructor Operator">▷</a> <a id="5212" href="Data.Empty.html#526" class="Datatype">⊥</a> <a id="5214" href="internal-library.html#24" class="Function Operator">&lt;?&gt;</a> <a id="5218" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="NatC"></a><a id="5221" href="containers.html#5221" class="Function">NatC</a> <a id="5226" class="Symbol">=</a> <a id="5228" href="Data.Container.html#1520" class="Function">μ</a> <a id="5230" href="containers.html#5167" class="Function">NatCC</a>

<a id="ZeroC"></a><a id="5237" href="containers.html#5237" class="Function">ZeroC</a> <a id="5243" class="Symbol">:</a> <a id="5245" href="containers.html#5221" class="Function">NatC</a>
<a id="5250" href="containers.html#5237" class="Function">ZeroC</a> <a id="5256" class="Symbol">=</a> <a id="5258" href="Data.W.html#799" class="InductiveConstructor">sup</a> <a id="5262" class="Symbol">(</a><a id="5263" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="5268" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5270" href="Data.Empty.html#628" class="Function">⊥-elim</a><a id="5276" class="Symbol">)</a>

<a id="SucC"></a><a id="5279" href="containers.html#5279" class="Function">SucC</a> <a id="5284" class="Symbol">:</a> <a id="5286" href="containers.html#5221" class="Function">NatC</a> <a id="5291" class="Symbol">→</a> <a id="5293" href="containers.html#5221" class="Function">NatC</a>
<a id="5298" href="containers.html#5279" class="Function">SucC</a> <a id="5303" href="containers.html#5303" class="Bound">n</a> <a id="5305" class="Symbol">=</a> <a id="5307" href="Data.W.html#799" class="InductiveConstructor">sup</a> <a id="5311" class="Symbol">(</a><a id="5312" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="5318" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5320" href="Function.Base.html#636" class="Function">F.const</a> <a id="5328" href="containers.html#5303" class="Bound">n</a><a id="5329" class="Symbol">)</a>
</pre>
    </section>
</article>

        </main>

        <footer>
            Site proudly generated by
            <a style="color:yellow;" href="http://jaspervdj.be/hakyll">Hakyll</a> with
            <a style="color:yellow;" href="https://github.com/guilhermehas/guilhermehas.github.io">source code</a>
        </footer>
    </body>
</html>
