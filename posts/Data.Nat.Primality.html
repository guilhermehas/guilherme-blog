<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.Primality</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Primality</a>
<a id="119" class="Comment">------------------------------------------------------------------------</a>

<a id="193" class="Symbol">{-#</a> <a id="197" class="Keyword">OPTIONS</a> <a id="205" class="Pragma">--without-K</a> <a id="217" class="Pragma">--safe</a> <a id="224" class="Symbol">#-}</a>

<a id="229" class="Keyword">module</a> <a id="236" href="Data.Nat.Primality.html" class="Module">Data.Nat.Primality</a> <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="285" class="Keyword">using</a> <a id="291" class="Symbol">(</a><a id="292" href="Data.Empty.html#886" class="Function">⊥</a><a id="293" class="Symbol">)</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Data.Nat.GCD.html" class="Module">Data.Nat.GCD</a> <a id="380" class="Keyword">using</a> <a id="386" class="Symbol">(</a><a id="387" class="Keyword">module</a> <a id="394" href="Data.Nat.GCD.html#6150" class="Module">GCD</a><a id="397" class="Symbol">;</a> <a id="399" class="Keyword">module</a> <a id="406" href="Data.Nat.GCD.html#9085" class="Module">Bézout</a><a id="412" class="Symbol">)</a>
<a id="414" class="Keyword">open</a> <a id="419" class="Keyword">import</a> <a id="426" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="446" class="Keyword">open</a> <a id="451" class="Keyword">import</a> <a id="458" href="Data.Product.html" class="Module">Data.Product</a>
<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="497" class="Keyword">using</a> <a id="503" class="Symbol">(</a><a id="504" href="Data.Sum.Base.html#734" class="Datatype Operator">_⊎_</a><a id="507" class="Symbol">;</a> <a id="509" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a><a id="513" class="Symbol">;</a> <a id="515" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a><a id="519" class="Symbol">)</a>
<a id="521" class="Keyword">open</a> <a id="526" class="Keyword">import</a> <a id="533" href="Function.Base.html" class="Module">Function.Base</a> <a id="547" class="Keyword">using</a> <a id="553" class="Symbol">(</a><a id="554" href="Function.Base.html#1629" class="Function">flip</a><a id="558" class="Symbol">;</a> <a id="560" href="Function.Base.html#1106" class="Function Operator">_∘_</a><a id="563" class="Symbol">;</a> <a id="565" href="Function.Base.html#3637" class="Function Operator">_∘′_</a><a id="569" class="Symbol">)</a>
<a id="571" class="Keyword">open</a> <a id="576" class="Keyword">import</a> <a id="583" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="600" class="Keyword">using</a> <a id="606" class="Symbol">(</a><a id="607" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="610" class="Symbol">;</a> <a id="612" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="614" class="Symbol">;</a> <a id="616" href="Relation.Nullary.html#656" class="Function Operator">¬_</a><a id="618" class="Symbol">)</a>
<a id="620" class="Keyword">open</a> <a id="625" class="Keyword">import</a> <a id="632" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="659" class="Symbol">as</a> <a id="662" class="Module">Dec</a> <a id="666" class="Keyword">using</a> <a id="672" class="Symbol">(</a><a id="673" href="Relation.Nullary.Decidable.Core.html#2352" class="Function">from-yes</a><a id="681" class="Symbol">)</a>
<a id="683" class="Keyword">open</a> <a id="688" class="Keyword">import</a> <a id="695" href="Relation.Nullary.Product.html" class="Module">Relation.Nullary.Product</a> <a id="720" class="Keyword">using</a> <a id="726" class="Symbol">(</a><a id="727" href="Relation.Nullary.Product.html#921" class="Function Operator">_×-dec_</a><a id="734" class="Symbol">)</a>
<a id="736" class="Keyword">open</a> <a id="741" class="Keyword">import</a> <a id="748" href="Relation.Nullary.Implication.html" class="Module">Relation.Nullary.Implication</a> <a id="777" class="Keyword">using</a> <a id="783" class="Symbol">(</a><a id="784" href="Relation.Nullary.Implication.html#885" class="Function Operator">_→-dec_</a><a id="791" class="Symbol">)</a>
<a id="793" class="Keyword">open</a> <a id="798" class="Keyword">import</a> <a id="805" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="831" class="Keyword">using</a> <a id="837" class="Symbol">(</a><a id="838" href="Relation.Nullary.Negation.Core.html#1355" class="Function">¬?</a><a id="840" class="Symbol">;</a> <a id="842" href="Relation.Nullary.Negation.Core.html#778" class="Function">contradiction</a><a id="855" class="Symbol">;</a> <a id="857" href="Relation.Nullary.Negation.html#1050" class="Function">decidable-stable</a><a id="873" class="Symbol">)</a>
<a id="875" class="Keyword">open</a> <a id="880" class="Keyword">import</a> <a id="887" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="902" class="Keyword">using</a> <a id="908" class="Symbol">(</a><a id="909" href="Relation.Unary.html#3675" class="Function">Decidable</a><a id="918" class="Symbol">)</a>
<a id="920" class="Keyword">open</a> <a id="925" class="Keyword">import</a> <a id="932" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="970" class="Keyword">using</a> <a id="976" class="Symbol">(</a><a id="977" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="981" class="Symbol">;</a> <a id="983" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a><a id="986" class="Symbol">;</a> <a id="988" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="992" class="Symbol">;</a> <a id="994" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a><a id="999" class="Symbol">)</a>

<a id="1002" class="Keyword">private</a>
  <a id="1012" class="Keyword">variable</a>
    <a id="1025" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a> <a id="1027" class="Symbol">:</a> <a id="1029" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1032" class="Comment">------------------------------------------------------------------------</a>
<a id="1105" class="Comment">-- Definitions</a>

<a id="1121" class="Comment">-- Definition of compositeness</a>

<a id="Composite"></a><a id="1153" href="Data.Nat.Primality.html#1153" class="Function">Composite</a> <a id="1163" class="Symbol">:</a> <a id="1165" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1167" class="Symbol">→</a> <a id="1169" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1173" href="Data.Nat.Primality.html#1153" class="Function">Composite</a> <a id="1183" class="Number">0</a> <a id="1185" class="Symbol">=</a> <a id="1187" href="Data.Empty.html#886" class="Function">⊥</a>
<a id="1189" href="Data.Nat.Primality.html#1153" class="Function">Composite</a> <a id="1199" class="Number">1</a> <a id="1201" class="Symbol">=</a> <a id="1203" href="Data.Empty.html#886" class="Function">⊥</a>
<a id="1205" href="Data.Nat.Primality.html#1153" class="CatchallClause Function">Composite</a><a id="1214" class="CatchallClause"> </a><a id="1215" href="Data.Nat.Primality.html#1215" class="CatchallClause Bound">n</a> <a id="1217" class="Symbol">=</a> <a id="1219" href="Data.Product.html#1369" class="Function">∃</a> <a id="1221" class="Symbol">λ</a> <a id="1223" href="Data.Nat.Primality.html#1223" class="Bound">d</a> <a id="1225" class="Symbol">→</a> <a id="1227" class="Number">2</a> <a id="1229" href="Data.Nat.Base.html#1464" class="Datatype Operator">≤</a> <a id="1231" href="Data.Nat.Primality.html#1223" class="Bound">d</a> <a id="1233" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1235" href="Data.Nat.Primality.html#1223" class="Bound">d</a> <a id="1237" href="Data.Nat.Base.html#1574" class="Function Operator">&lt;</a> <a id="1239" href="Data.Nat.Primality.html#1215" class="Bound">n</a> <a id="1241" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1243" href="Data.Nat.Primality.html#1223" class="Bound">d</a> <a id="1245" href="Data.Nat.Divisibility.Core.html#1137" class="Record Operator">∣</a> <a id="1247" href="Data.Nat.Primality.html#1215" class="Bound">n</a>

<a id="1250" class="Comment">-- Definition of primality.</a>

<a id="Prime"></a><a id="1279" href="Data.Nat.Primality.html#1279" class="Function">Prime</a> <a id="1285" class="Symbol">:</a> <a id="1287" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1289" class="Symbol">→</a> <a id="1291" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1295" href="Data.Nat.Primality.html#1279" class="Function">Prime</a> <a id="1301" class="Number">0</a> <a id="1303" class="Symbol">=</a> <a id="1305" href="Data.Empty.html#886" class="Function">⊥</a>
<a id="1307" href="Data.Nat.Primality.html#1279" class="Function">Prime</a> <a id="1313" class="Number">1</a> <a id="1315" class="Symbol">=</a> <a id="1317" href="Data.Empty.html#886" class="Function">⊥</a>
<a id="1319" href="Data.Nat.Primality.html#1279" class="CatchallClause Function">Prime</a><a id="1324" class="CatchallClause"> </a><a id="1325" href="Data.Nat.Primality.html#1325" class="CatchallClause Bound">n</a> <a id="1327" class="Symbol">=</a> <a id="1329" class="Symbol">∀</a> <a id="1331" class="Symbol">{</a><a id="1332" href="Data.Nat.Primality.html#1332" class="Bound">d</a><a id="1333" class="Symbol">}</a> <a id="1335" class="Symbol">→</a> <a id="1337" class="Number">2</a> <a id="1339" href="Data.Nat.Base.html#1464" class="Datatype Operator">≤</a> <a id="1341" href="Data.Nat.Primality.html#1332" class="Bound">d</a> <a id="1343" class="Symbol">→</a> <a id="1345" href="Data.Nat.Primality.html#1332" class="Bound">d</a> <a id="1347" href="Data.Nat.Base.html#1574" class="Function Operator">&lt;</a> <a id="1349" href="Data.Nat.Primality.html#1325" class="Bound">n</a> <a id="1351" class="Symbol">→</a> <a id="1353" href="Data.Nat.Primality.html#1332" class="Bound">d</a> <a id="1355" href="Data.Nat.Divisibility.Core.html#1276" class="Function Operator">∤</a> <a id="1357" href="Data.Nat.Primality.html#1325" class="Bound">n</a>

<a id="1360" class="Comment">------------------------------------------------------------------------</a>
<a id="1433" class="Comment">-- Decidability</a>

<a id="composite?"></a><a id="1450" href="Data.Nat.Primality.html#1450" class="Function">composite?</a> <a id="1461" class="Symbol">:</a> <a id="1463" href="Relation.Unary.html#3675" class="Function">Decidable</a> <a id="1473" href="Data.Nat.Primality.html#1153" class="Function">Composite</a>
<a id="1483" href="Data.Nat.Primality.html#1450" class="Function">composite?</a> <a id="1494" class="Number">0</a>               <a id="1510" class="Symbol">=</a> <a id="1512" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1515" class="Symbol">λ()</a>
<a id="1519" href="Data.Nat.Primality.html#1450" class="Function">composite?</a> <a id="1530" class="Number">1</a>               <a id="1546" class="Symbol">=</a> <a id="1548" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1551" class="Symbol">λ()</a>
<a id="1555" href="Data.Nat.Primality.html#1450" class="Function">composite?</a> <a id="1566" href="Data.Nat.Primality.html#1566" class="Bound">n</a><a id="1567" class="Symbol">@(</a><a id="1569" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1573" class="Symbol">(</a><a id="1574" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1578" class="Symbol">_))</a> <a id="1582" class="Symbol">=</a> <a id="1584" href="Relation.Nullary.Decidable.Core.html#3621" class="Function">Dec.map′</a>
  <a id="1595" class="Symbol">(</a><a id="1596" href="Data.Product.html#2675" class="Function">map₂</a> <a id="1601" class="Symbol">λ</a> <a id="1603" class="Symbol">{</a> <a id="1605" class="Symbol">(</a><a id="1606" href="Data.Nat.Primality.html#1606" class="Bound">a</a> <a id="1608" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1610" href="Data.Nat.Primality.html#1610" class="Bound">b</a> <a id="1612" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1614" href="Data.Nat.Primality.html#1614" class="Bound">c</a><a id="1615" class="Symbol">)</a> <a id="1617" class="Symbol">→</a> <a id="1619" class="Symbol">(</a><a id="1620" href="Data.Nat.Primality.html#1610" class="Bound">b</a> <a id="1622" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1624" href="Data.Nat.Primality.html#1606" class="Bound">a</a> <a id="1626" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1628" href="Data.Nat.Primality.html#1614" class="Bound">c</a><a id="1629" class="Symbol">)})</a>
  <a id="1635" class="Symbol">(</a><a id="1636" href="Data.Product.html#2675" class="Function">map₂</a> <a id="1641" class="Symbol">λ</a> <a id="1643" class="Symbol">{</a> <a id="1645" class="Symbol">(</a><a id="1646" href="Data.Nat.Primality.html#1646" class="Bound">a</a> <a id="1648" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1650" href="Data.Nat.Primality.html#1650" class="Bound">b</a> <a id="1652" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1654" href="Data.Nat.Primality.html#1654" class="Bound">c</a><a id="1655" class="Symbol">)</a> <a id="1657" class="Symbol">→</a> <a id="1659" class="Symbol">(</a><a id="1660" href="Data.Nat.Primality.html#1650" class="Bound">b</a> <a id="1662" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1664" href="Data.Nat.Primality.html#1646" class="Bound">a</a> <a id="1666" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1668" href="Data.Nat.Primality.html#1654" class="Bound">c</a><a id="1669" class="Symbol">)})</a>
  <a id="1675" class="Symbol">(</a><a id="1676" href="Data.Nat.Properties.html#64562" class="Function">anyUpTo?</a> <a id="1685" class="Symbol">(λ</a> <a id="1688" href="Data.Nat.Primality.html#1688" class="Bound">d</a> <a id="1690" class="Symbol">→</a> <a id="1692" class="Number">2</a> <a id="1694" href="Data.Nat.Properties.html#5874" class="Function Operator">≤?</a> <a id="1697" href="Data.Nat.Primality.html#1688" class="Bound">d</a> <a id="1699" href="Relation.Nullary.Product.html#921" class="Function Operator">×-dec</a> <a id="1705" href="Data.Nat.Primality.html#1688" class="Bound">d</a> <a id="1707" href="Data.Nat.Divisibility.html#2713" class="Function Operator">∣?</a> <a id="1710" href="Data.Nat.Primality.html#1566" class="Bound">n</a><a id="1711" class="Symbol">)</a> <a id="1713" href="Data.Nat.Primality.html#1566" class="Bound">n</a><a id="1714" class="Symbol">)</a>

<a id="prime?"></a><a id="1717" href="Data.Nat.Primality.html#1717" class="Function">prime?</a> <a id="1724" class="Symbol">:</a> <a id="1726" href="Relation.Unary.html#3675" class="Function">Decidable</a> <a id="1736" href="Data.Nat.Primality.html#1279" class="Function">Prime</a>
<a id="1742" href="Data.Nat.Primality.html#1717" class="Function">prime?</a> <a id="1749" class="Number">0</a>                 <a id="1767" class="Symbol">=</a> <a id="1769" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1772" class="Symbol">λ()</a>
<a id="1776" href="Data.Nat.Primality.html#1717" class="Function">prime?</a> <a id="1783" class="Number">1</a>                 <a id="1801" class="Symbol">=</a> <a id="1803" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1806" class="Symbol">λ()</a>
<a id="1810" href="Data.Nat.Primality.html#1717" class="Function">prime?</a> <a id="1817" href="Data.Nat.Primality.html#1817" class="Bound">n</a><a id="1818" class="Symbol">@(</a><a id="1820" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1824" class="Symbol">(</a><a id="1825" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1829" href="Data.Nat.Primality.html#1829" class="Bound">n-2</a><a id="1832" class="Symbol">))</a> <a id="1835" class="Symbol">=</a> <a id="1837" href="Relation.Nullary.Decidable.Core.html#3621" class="Function">Dec.map′</a>
  <a id="1848" class="Symbol">(λ</a> <a id="1851" href="Data.Nat.Primality.html#1851" class="Bound">f</a> <a id="1853" class="Symbol">{</a><a id="1854" href="Data.Nat.Primality.html#1854" class="Bound">d</a><a id="1855" class="Symbol">}</a> <a id="1857" class="Symbol">→</a> <a id="1859" href="Function.Base.html#1629" class="Function">flip</a> <a id="1864" class="Symbol">(</a><a id="1865" href="Data.Nat.Primality.html#1851" class="Bound">f</a> <a id="1867" class="Symbol">{</a><a id="1868" href="Data.Nat.Primality.html#1854" class="Bound">d</a><a id="1869" class="Symbol">}))</a>
  <a id="1875" class="Symbol">(λ</a> <a id="1878" href="Data.Nat.Primality.html#1878" class="Bound">f</a> <a id="1880" class="Symbol">{</a><a id="1881" href="Data.Nat.Primality.html#1881" class="Bound">d</a><a id="1882" class="Symbol">}</a> <a id="1884" class="Symbol">→</a> <a id="1886" href="Function.Base.html#1629" class="Function">flip</a> <a id="1891" class="Symbol">(</a><a id="1892" href="Data.Nat.Primality.html#1878" class="Bound">f</a> <a id="1894" class="Symbol">{</a><a id="1895" href="Data.Nat.Primality.html#1881" class="Bound">d</a><a id="1896" class="Symbol">}))</a>
  <a id="1902" class="Symbol">(</a><a id="1903" href="Data.Nat.Properties.html#65034" class="Function">allUpTo?</a> <a id="1912" class="Symbol">(λ</a> <a id="1915" href="Data.Nat.Primality.html#1915" class="Bound">d</a> <a id="1917" class="Symbol">→</a> <a id="1919" class="Number">2</a> <a id="1921" href="Data.Nat.Properties.html#5874" class="Function Operator">≤?</a> <a id="1924" href="Data.Nat.Primality.html#1915" class="Bound">d</a> <a id="1926" href="Relation.Nullary.Implication.html#885" class="Function Operator">→-dec</a> <a id="1932" href="Relation.Nullary.Negation.Core.html#1355" class="Function">¬?</a> <a id="1935" class="Symbol">(</a><a id="1936" href="Data.Nat.Primality.html#1915" class="Bound">d</a> <a id="1938" href="Data.Nat.Divisibility.html#2713" class="Function Operator">∣?</a> <a id="1941" href="Data.Nat.Primality.html#1817" class="Bound">n</a><a id="1942" class="Symbol">))</a> <a id="1945" href="Data.Nat.Primality.html#1817" class="Bound">n</a><a id="1946" class="Symbol">)</a>

<a id="1949" class="Comment">------------------------------------------------------------------------</a>
<a id="2022" class="Comment">-- Relationships between compositeness and primality</a>

<a id="composite⇒¬prime"></a><a id="2076" href="Data.Nat.Primality.html#2076" class="Function">composite⇒¬prime</a> <a id="2093" class="Symbol">:</a> <a id="2095" href="Data.Nat.Primality.html#1153" class="Function">Composite</a> <a id="2105" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a> <a id="2107" class="Symbol">→</a> <a id="2109" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="2111" href="Data.Nat.Primality.html#1279" class="Function">Prime</a> <a id="2117" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a>
<a id="2119" href="Data.Nat.Primality.html#2076" class="Function">composite⇒¬prime</a> <a id="2136" class="Symbol">{</a><a id="2137" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2141" class="Symbol">(</a><a id="2142" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2146" class="Symbol">_)}</a> <a id="2150" class="Symbol">(</a><a id="2151" href="Data.Nat.Primality.html#2151" class="Bound">d</a> <a id="2153" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2155" href="Data.Nat.Primality.html#2155" class="Bound">2≤d</a> <a id="2159" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2161" href="Data.Nat.Primality.html#2161" class="Bound">d&lt;n</a> <a id="2165" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2167" href="Data.Nat.Primality.html#2167" class="Bound">d∣n</a><a id="2170" class="Symbol">)</a> <a id="2172" href="Data.Nat.Primality.html#2172" class="Bound">n-prime</a> <a id="2180" class="Symbol">=</a>
  <a id="2184" href="Data.Nat.Primality.html#2172" class="Bound">n-prime</a> <a id="2192" href="Data.Nat.Primality.html#2155" class="Bound">2≤d</a> <a id="2196" href="Data.Nat.Primality.html#2161" class="Bound">d&lt;n</a> <a id="2200" href="Data.Nat.Primality.html#2167" class="Bound">d∣n</a>

<a id="¬composite⇒prime"></a><a id="2205" href="Data.Nat.Primality.html#2205" class="Function">¬composite⇒prime</a> <a id="2222" class="Symbol">:</a> <a id="2224" class="Number">2</a> <a id="2226" href="Data.Nat.Base.html#1464" class="Datatype Operator">≤</a> <a id="2228" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a> <a id="2230" class="Symbol">→</a> <a id="2232" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="2234" href="Data.Nat.Primality.html#1153" class="Function">Composite</a> <a id="2244" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a> <a id="2246" class="Symbol">→</a> <a id="2248" href="Data.Nat.Primality.html#1279" class="Function">Prime</a> <a id="2254" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a>
<a id="2256" href="Data.Nat.Primality.html#2205" class="Function">¬composite⇒prime</a> <a id="2273" class="Symbol">(</a><a id="2274" href="Data.Nat.Base.html#1529" class="InductiveConstructor">s≤s</a> <a id="2278" class="Symbol">(</a><a id="2279" href="Data.Nat.Base.html#1529" class="InductiveConstructor">s≤s</a> <a id="2283" class="Symbol">_))</a> <a id="2287" href="Data.Nat.Primality.html#2287" class="Bound">¬n-composite</a> <a id="2300" class="Symbol">{</a><a id="2301" href="Data.Nat.Primality.html#2301" class="Bound">d</a><a id="2302" class="Symbol">}</a> <a id="2304" href="Data.Nat.Primality.html#2304" class="Bound">2≤d</a> <a id="2308" href="Data.Nat.Primality.html#2308" class="Bound">d&lt;n</a> <a id="2312" href="Data.Nat.Primality.html#2312" class="Bound">d∣n</a> <a id="2316" class="Symbol">=</a>
  <a id="2320" href="Data.Nat.Primality.html#2287" class="Bound">¬n-composite</a> <a id="2333" class="Symbol">(</a><a id="2334" href="Data.Nat.Primality.html#2301" class="Bound">d</a> <a id="2336" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2338" href="Data.Nat.Primality.html#2304" class="Bound">2≤d</a> <a id="2342" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2344" href="Data.Nat.Primality.html#2308" class="Bound">d&lt;n</a> <a id="2348" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2350" href="Data.Nat.Primality.html#2312" class="Bound">d∣n</a><a id="2353" class="Symbol">)</a>

<a id="prime⇒¬composite"></a><a id="2356" href="Data.Nat.Primality.html#2356" class="Function">prime⇒¬composite</a> <a id="2373" class="Symbol">:</a> <a id="2375" href="Data.Nat.Primality.html#1279" class="Function">Prime</a> <a id="2381" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a> <a id="2383" class="Symbol">→</a> <a id="2385" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="2387" href="Data.Nat.Primality.html#1153" class="Function">Composite</a> <a id="2397" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a>
<a id="2399" href="Data.Nat.Primality.html#2356" class="Function">prime⇒¬composite</a> <a id="2416" class="Symbol">{</a><a id="2417" href="Data.Nat.Primality.html#2417" class="Bound">n</a><a id="2418" class="Symbol">@(</a><a id="2420" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2424" class="Symbol">(</a><a id="2425" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2429" class="Symbol">_))}</a> <a id="2434" href="Data.Nat.Primality.html#2434" class="Bound">n-prime</a> <a id="2442" class="Symbol">(</a><a id="2443" href="Data.Nat.Primality.html#2443" class="Bound">d</a> <a id="2445" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2447" href="Data.Nat.Primality.html#2447" class="Bound">2≤d</a> <a id="2451" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2453" href="Data.Nat.Primality.html#2453" class="Bound">d&lt;n</a> <a id="2457" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2459" href="Data.Nat.Primality.html#2459" class="Bound">d∣n</a><a id="2462" class="Symbol">)</a> <a id="2464" class="Symbol">=</a>
  <a id="2468" href="Data.Nat.Primality.html#2434" class="Bound">n-prime</a> <a id="2476" href="Data.Nat.Primality.html#2447" class="Bound">2≤d</a> <a id="2480" href="Data.Nat.Primality.html#2453" class="Bound">d&lt;n</a> <a id="2484" href="Data.Nat.Primality.html#2459" class="Bound">d∣n</a>

<a id="2489" class="Comment">-- note that this has to recompute the factor!</a>
<a id="¬prime⇒composite"></a><a id="2536" href="Data.Nat.Primality.html#2536" class="Function">¬prime⇒composite</a> <a id="2553" class="Symbol">:</a> <a id="2555" class="Number">2</a> <a id="2557" href="Data.Nat.Base.html#1464" class="Datatype Operator">≤</a> <a id="2559" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a> <a id="2561" class="Symbol">→</a> <a id="2563" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="2565" href="Data.Nat.Primality.html#1279" class="Function">Prime</a> <a id="2571" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a> <a id="2573" class="Symbol">→</a> <a id="2575" href="Data.Nat.Primality.html#1153" class="Function">Composite</a> <a id="2585" href="Data.Nat.Primality.html#1025" class="Generalizable">n</a>
<a id="2587" href="Data.Nat.Primality.html#2536" class="Function">¬prime⇒composite</a> <a id="2604" class="Symbol">{</a><a id="2605" href="Data.Nat.Primality.html#2605" class="Bound">n</a><a id="2606" class="Symbol">}</a> <a id="2608" href="Data.Nat.Primality.html#2608" class="Bound">2≤n</a> <a id="2612" href="Data.Nat.Primality.html#2612" class="Bound">¬n-prime</a> <a id="2621" class="Symbol">=</a>
  <a id="2625" href="Relation.Nullary.Negation.html#1050" class="Function">decidable-stable</a> <a id="2642" class="Symbol">(</a><a id="2643" href="Data.Nat.Primality.html#1450" class="Function">composite?</a> <a id="2654" href="Data.Nat.Primality.html#2605" class="Bound">n</a><a id="2655" class="Symbol">)</a> <a id="2657" class="Symbol">(</a><a id="2658" href="Data.Nat.Primality.html#2612" class="Bound">¬n-prime</a> <a id="2667" href="Function.Base.html#3637" class="Function Operator">∘′</a> <a id="2670" href="Data.Nat.Primality.html#2205" class="Function">¬composite⇒prime</a> <a id="2687" href="Data.Nat.Primality.html#2608" class="Bound">2≤n</a><a id="2690" class="Symbol">)</a>

<a id="2693" class="Comment">------------------------------------------------------------------------</a>
<a id="2766" class="Comment">-- Euclid&#39;s lemma</a>

<a id="2785" class="Comment">-- For p prime, if p ∣ m * n, then either p ∣ m or p ∣ n.</a>
<a id="2843" class="Comment">-- This demonstrates that the usual definition of prime numbers matches the</a>
<a id="2919" class="Comment">-- ring theoretic definition of a prime element of the semiring ℕ.</a>
<a id="2986" class="Comment">-- This is useful for proving many other theorems involving prime numbers.</a>
<a id="euclidsLemma"></a><a id="3061" href="Data.Nat.Primality.html#3061" class="Function">euclidsLemma</a> <a id="3074" class="Symbol">:</a> <a id="3076" class="Symbol">∀</a> <a id="3078" href="Data.Nat.Primality.html#3078" class="Bound">m</a> <a id="3080" href="Data.Nat.Primality.html#3080" class="Bound">n</a> <a id="3082" class="Symbol">{</a><a id="3083" href="Data.Nat.Primality.html#3083" class="Bound">p</a><a id="3084" class="Symbol">}</a> <a id="3086" class="Symbol">→</a> <a id="3088" href="Data.Nat.Primality.html#1279" class="Function">Prime</a> <a id="3094" href="Data.Nat.Primality.html#3083" class="Bound">p</a> <a id="3096" class="Symbol">→</a> <a id="3098" href="Data.Nat.Primality.html#3083" class="Bound">p</a> <a id="3100" href="Data.Nat.Divisibility.Core.html#1137" class="Record Operator">∣</a> <a id="3102" href="Data.Nat.Primality.html#3078" class="Bound">m</a> <a id="3104" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3106" href="Data.Nat.Primality.html#3080" class="Bound">n</a> <a id="3108" class="Symbol">→</a> <a id="3110" href="Data.Nat.Primality.html#3083" class="Bound">p</a> <a id="3112" href="Data.Nat.Divisibility.Core.html#1137" class="Record Operator">∣</a> <a id="3114" href="Data.Nat.Primality.html#3078" class="Bound">m</a> <a id="3116" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="3118" href="Data.Nat.Primality.html#3083" class="Bound">p</a> <a id="3120" href="Data.Nat.Divisibility.Core.html#1137" class="Record Operator">∣</a> <a id="3122" href="Data.Nat.Primality.html#3080" class="Bound">n</a>
<a id="3124" href="Data.Nat.Primality.html#3061" class="Function">euclidsLemma</a> <a id="3137" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="3139" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="3141" class="Symbol">{</a><a id="3142" href="Data.Nat.Primality.html#3142" class="Bound">p</a><a id="3143" class="Symbol">@(</a><a id="3145" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3149" class="Symbol">(</a><a id="3150" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3154" class="Symbol">_))}</a> <a id="3159" href="Data.Nat.Primality.html#3159" class="Bound">p-prime</a> <a id="3167" href="Data.Nat.Primality.html#3167" class="Bound">p∣m*n</a> <a id="3173" class="Symbol">=</a> <a id="3175" href="Data.Nat.Primality.html#3371" class="Function">result</a>
  <a id="3184" class="Keyword">where</a>
  <a id="3192" class="Keyword">open</a> <a id="3197" href="Data.Nat.Divisibility.html#3484" class="Module">∣-Reasoning</a>

  <a id="3212" href="Data.Nat.Primality.html#3212" class="Function">p∣rmn</a> <a id="3218" class="Symbol">:</a> <a id="3220" class="Symbol">∀</a> <a id="3222" href="Data.Nat.Primality.html#3222" class="Bound">r</a> <a id="3224" class="Symbol">→</a> <a id="3226" href="Data.Nat.Primality.html#3142" class="Bound">p</a> <a id="3228" href="Data.Nat.Divisibility.Core.html#1137" class="Record Operator">∣</a> <a id="3230" href="Data.Nat.Primality.html#3222" class="Bound">r</a> <a id="3232" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3234" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="3236" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3238" href="Data.Nat.Primality.html#3139" class="Bound">n</a>
  <a id="3242" href="Data.Nat.Primality.html#3212" class="Function">p∣rmn</a> <a id="3248" href="Data.Nat.Primality.html#3248" class="Bound">r</a> <a id="3250" class="Symbol">=</a> <a id="3252" href="Relation.Binary.Reasoning.Base.Double.html#2213" class="Function Operator">begin</a>
    <a id="3262" href="Data.Nat.Primality.html#3142" class="Bound">p</a>           <a id="3274" href="Data.Nat.Divisibility.html#3637" class="Function">∣⟨</a> <a id="3277" href="Data.Nat.Primality.html#3167" class="Bound">p∣m*n</a> <a id="3283" href="Data.Nat.Divisibility.html#3637" class="Function">⟩</a>
    <a id="3289" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="3291" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3293" href="Data.Nat.Primality.html#3139" class="Bound">n</a>       <a id="3301" href="Data.Nat.Divisibility.html#3637" class="Function">∣⟨</a> <a id="3304" href="Data.Nat.Divisibility.html#4820" class="Function">n∣m*n</a> <a id="3310" href="Data.Nat.Primality.html#3248" class="Bound">r</a> <a id="3312" href="Data.Nat.Divisibility.html#3637" class="Function">⟩</a>
    <a id="3318" href="Data.Nat.Primality.html#3248" class="Bound">r</a> <a id="3320" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3322" class="Symbol">(</a><a id="3323" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="3325" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3327" href="Data.Nat.Primality.html#3139" class="Bound">n</a><a id="3328" class="Symbol">)</a> <a id="3330" href="Relation.Binary.Reasoning.Base.Double.html#3398" class="Function">≡˘⟨</a> <a id="3334" href="Data.Nat.Properties.html#22210" class="Function">*-assoc</a> <a id="3342" href="Data.Nat.Primality.html#3248" class="Bound">r</a> <a id="3344" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="3346" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="3348" href="Relation.Binary.Reasoning.Base.Double.html#3398" class="Function">⟩</a>
    <a id="3354" href="Data.Nat.Primality.html#3248" class="Bound">r</a> <a id="3356" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3358" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="3360" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3362" href="Data.Nat.Primality.html#3139" class="Bound">n</a>   <a id="3366" href="Relation.Binary.Reasoning.Base.Double.html#3647" class="Function Operator">∎</a>

  <a id="3371" href="Data.Nat.Primality.html#3371" class="Function">result</a> <a id="3378" class="Symbol">:</a> <a id="3380" href="Data.Nat.Primality.html#3142" class="Bound">p</a> <a id="3382" href="Data.Nat.Divisibility.Core.html#1137" class="Record Operator">∣</a> <a id="3384" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="3386" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="3388" href="Data.Nat.Primality.html#3142" class="Bound">p</a> <a id="3390" href="Data.Nat.Divisibility.Core.html#1137" class="Record Operator">∣</a> <a id="3392" href="Data.Nat.Primality.html#3139" class="Bound">n</a>
  <a id="3396" href="Data.Nat.Primality.html#3371" class="Function">result</a> <a id="3403" class="Keyword">with</a> <a id="3408" href="Data.Nat.GCD.html#11562" class="Function">Bézout.lemma</a> <a id="3421" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="3423" href="Data.Nat.Primality.html#3142" class="Bound">p</a>
  <a id="3427" class="Comment">-- if the GCD of m and p is zero then p must be zero, which is impossible as p</a>
  <a id="3508" class="Comment">-- is a prime</a>
  <a id="3524" href="Data.Nat.Primality.html#3371" class="Function">...</a> <a id="3528" class="Symbol">|</a> <a id="3530" href="Data.Nat.GCD.html#10788" class="InductiveConstructor">Bézout.result</a> <a id="3544" class="Number">0</a> <a id="3546" href="Data.Nat.Primality.html#3546" class="Bound">g</a> <a id="3548" class="Symbol">_</a> <a id="3550" class="Symbol">=</a> <a id="3552" href="Relation.Nullary.Negation.Core.html#778" class="Function">contradiction</a> <a id="3566" class="Symbol">(</a><a id="3567" href="Data.Nat.Divisibility.html#3921" class="Function">0∣⇒≡0</a> <a id="3573" class="Symbol">(</a><a id="3574" href="Data.Nat.GCD.html#6635" class="Function">GCD.gcd∣n</a> <a id="3584" href="Data.Nat.Primality.html#3546" class="Bound">g</a><a id="3585" class="Symbol">))</a> <a id="3588" class="Symbol">λ()</a>

  <a id="3595" class="Comment">-- if the GCD of m and p is one then m and p is coprime, and we know that for</a>
  <a id="3675" class="Comment">-- some integers s and r, sm + rp = 1. We can use this fact to determine that p</a>
  <a id="3757" class="Comment">-- divides n</a>
  <a id="3772" href="Data.Nat.Primality.html#3371" class="Function">...</a> <a id="3776" class="Symbol">|</a> <a id="3778" href="Data.Nat.GCD.html#10788" class="InductiveConstructor">Bézout.result</a> <a id="3792" class="Number">1</a> <a id="3794" class="Symbol">_</a> <a id="3796" class="Symbol">(</a><a id="3797" href="Data.Nat.GCD.html#9510" class="InductiveConstructor">Bézout.+-</a> <a id="3807" href="Data.Nat.Primality.html#3807" class="Bound">r</a> <a id="3809" href="Data.Nat.Primality.html#3809" class="Bound">s</a> <a id="3811" href="Data.Nat.Primality.html#3811" class="Bound">1+sp≡rm</a><a id="3818" class="Symbol">)</a> <a id="3820" class="Symbol">=</a>
    <a id="3826" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="3831" class="Symbol">(</a><a id="3832" href="Function.Base.html#1629" class="Function">flip</a> <a id="3837" href="Data.Nat.Divisibility.html#4340" class="Function">∣m+n∣m⇒∣n</a> <a id="3847" class="Symbol">(</a><a id="3848" href="Data.Nat.Divisibility.html#4936" class="Function">n∣m*n*o</a> <a id="3856" href="Data.Nat.Primality.html#3809" class="Bound">s</a> <a id="3858" href="Data.Nat.Primality.html#3139" class="Bound">n</a><a id="3859" class="Symbol">)</a> <a id="3861" class="Symbol">(</a><a id="3862" href="Relation.Binary.Reasoning.Base.Double.html#2213" class="Function Operator">begin</a>
      <a id="3874" href="Data.Nat.Primality.html#3142" class="Bound">p</a>             <a id="3888" href="Data.Nat.Divisibility.html#3637" class="Function">∣⟨</a> <a id="3891" href="Data.Nat.Primality.html#3212" class="Function">p∣rmn</a> <a id="3897" href="Data.Nat.Primality.html#3807" class="Bound">r</a> <a id="3899" href="Data.Nat.Divisibility.html#3637" class="Function">⟩</a>
      <a id="3907" href="Data.Nat.Primality.html#3807" class="Bound">r</a> <a id="3909" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3911" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="3913" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3915" href="Data.Nat.Primality.html#3139" class="Bound">n</a>     <a id="3921" href="Relation.Binary.Reasoning.Base.Double.html#3398" class="Function">≡˘⟨</a> <a id="3925" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="3930" class="Symbol">(</a><a id="3931" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*</a> <a id="3934" href="Data.Nat.Primality.html#3139" class="Bound">n</a><a id="3935" class="Symbol">)</a> <a id="3937" href="Data.Nat.Primality.html#3811" class="Bound">1+sp≡rm</a> <a id="3945" href="Relation.Binary.Reasoning.Base.Double.html#3398" class="Function">⟩</a>
      <a id="3953" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="3955" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="3957" href="Data.Nat.Primality.html#3809" class="Bound">s</a> <a id="3959" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3961" href="Data.Nat.Primality.html#3142" class="Bound">p</a> <a id="3963" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3965" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="3967" href="Relation.Binary.Reasoning.Base.Double.html#3123" class="Function">≡⟨</a> <a id="3970" href="Data.Nat.Properties.html#14749" class="Function">+-comm</a> <a id="3977" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="3979" class="Symbol">(</a><a id="3980" href="Data.Nat.Primality.html#3809" class="Bound">s</a> <a id="3982" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3984" href="Data.Nat.Primality.html#3142" class="Bound">p</a> <a id="3986" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="3988" href="Data.Nat.Primality.html#3139" class="Bound">n</a><a id="3989" class="Symbol">)</a> <a id="3991" href="Relation.Binary.Reasoning.Base.Double.html#3123" class="Function">⟩</a>
      <a id="3999" href="Data.Nat.Primality.html#3809" class="Bound">s</a> <a id="4001" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4003" href="Data.Nat.Primality.html#3142" class="Bound">p</a> <a id="4005" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4007" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="4009" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4011" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="4013" href="Relation.Binary.Reasoning.Base.Double.html#3647" class="Function Operator">∎</a><a id="4014" class="Symbol">))</a>

  <a id="4020" href="Data.Nat.Primality.html#3371" class="Function">...</a> <a id="4024" class="Symbol">|</a> <a id="4026" href="Data.Nat.GCD.html#10788" class="InductiveConstructor">Bézout.result</a> <a id="4040" class="Number">1</a> <a id="4042" class="Symbol">_</a> <a id="4044" class="Symbol">(</a><a id="4045" href="Data.Nat.GCD.html#9573" class="InductiveConstructor">Bézout.-+</a> <a id="4055" href="Data.Nat.Primality.html#4055" class="Bound">r</a> <a id="4057" href="Data.Nat.Primality.html#4057" class="Bound">s</a> <a id="4059" href="Data.Nat.Primality.html#4059" class="Bound">1+rm≡sp</a><a id="4066" class="Symbol">)</a> <a id="4068" class="Symbol">=</a>
    <a id="4074" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="4079" class="Symbol">(</a><a id="4080" href="Function.Base.html#1629" class="Function">flip</a> <a id="4085" href="Data.Nat.Divisibility.html#4340" class="Function">∣m+n∣m⇒∣n</a> <a id="4095" class="Symbol">(</a><a id="4096" href="Data.Nat.Primality.html#3212" class="Function">p∣rmn</a> <a id="4102" href="Data.Nat.Primality.html#4055" class="Bound">r</a><a id="4103" class="Symbol">)</a> <a id="4105" class="Symbol">(</a><a id="4106" href="Relation.Binary.Reasoning.Base.Double.html#2213" class="Function Operator">begin</a>
      <a id="4118" href="Data.Nat.Primality.html#3142" class="Bound">p</a>             <a id="4132" href="Data.Nat.Divisibility.html#3637" class="Function">∣⟨</a> <a id="4135" href="Data.Nat.Divisibility.html#4936" class="Function">n∣m*n*o</a> <a id="4143" href="Data.Nat.Primality.html#4057" class="Bound">s</a> <a id="4145" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="4147" href="Data.Nat.Divisibility.html#3637" class="Function">⟩</a>
      <a id="4155" href="Data.Nat.Primality.html#4057" class="Bound">s</a> <a id="4157" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4159" href="Data.Nat.Primality.html#3142" class="Bound">p</a> <a id="4161" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4163" href="Data.Nat.Primality.html#3139" class="Bound">n</a>     <a id="4169" href="Relation.Binary.Reasoning.Base.Double.html#3398" class="Function">≡˘⟨</a> <a id="4173" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="4178" class="Symbol">(</a><a id="4179" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*</a> <a id="4182" href="Data.Nat.Primality.html#3139" class="Bound">n</a><a id="4183" class="Symbol">)</a> <a id="4185" href="Data.Nat.Primality.html#4059" class="Bound">1+rm≡sp</a> <a id="4193" href="Relation.Binary.Reasoning.Base.Double.html#3398" class="Function">⟩</a>
      <a id="4201" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="4203" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4205" href="Data.Nat.Primality.html#4055" class="Bound">r</a> <a id="4207" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4209" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="4211" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4213" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="4215" href="Relation.Binary.Reasoning.Base.Double.html#3123" class="Function">≡⟨</a> <a id="4218" href="Data.Nat.Properties.html#14749" class="Function">+-comm</a> <a id="4225" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="4227" class="Symbol">(</a><a id="4228" href="Data.Nat.Primality.html#4055" class="Bound">r</a> <a id="4230" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4232" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="4234" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4236" href="Data.Nat.Primality.html#3139" class="Bound">n</a><a id="4237" class="Symbol">)</a> <a id="4239" href="Relation.Binary.Reasoning.Base.Double.html#3123" class="Function">⟩</a>
      <a id="4247" href="Data.Nat.Primality.html#4055" class="Bound">r</a> <a id="4249" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4251" href="Data.Nat.Primality.html#3137" class="Bound">m</a> <a id="4253" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="4255" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="4257" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4259" href="Data.Nat.Primality.html#3139" class="Bound">n</a> <a id="4261" href="Relation.Binary.Reasoning.Base.Double.html#3647" class="Function Operator">∎</a><a id="4262" class="Symbol">))</a>

  <a id="4268" class="Comment">-- if the GCD of m and p is greater than one, then it must be p and hence p ∣ m.</a>
  <a id="4351" href="Data.Nat.Primality.html#3371" class="Function">...</a> <a id="4355" class="Symbol">|</a> <a id="4357" href="Data.Nat.GCD.html#10788" class="InductiveConstructor">Bézout.result</a> <a id="4371" href="Data.Nat.Primality.html#4371" class="Bound">d</a><a id="4372" class="Symbol">@(</a><a id="4374" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4378" class="Symbol">(</a><a id="4379" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4383" class="Symbol">_))</a> <a id="4387" href="Data.Nat.Primality.html#4387" class="Bound">g</a> <a id="4389" class="Symbol">_</a> <a id="4391" class="Keyword">with</a> <a id="4396" href="Data.Nat.Primality.html#4371" class="Bound">d</a> <a id="4398" href="Data.Nat.Properties.html#2936" class="Function Operator">≟</a> <a id="4400" href="Data.Nat.Primality.html#3142" class="Bound">p</a>
  <a id="4404" class="Symbol">...</a>   <a id="4410" class="Symbol">|</a> <a id="4412" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4416" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4421" class="Symbol">=</a> <a id="4423" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="4428" class="Symbol">(</a><a id="4429" href="Data.Nat.GCD.html#6582" class="Function">GCD.gcd∣m</a> <a id="4439" class="Bound">g</a><a id="4440" class="Symbol">)</a>
  <a id="4444" class="Symbol">...</a>   <a id="4450" class="Symbol">|</a> <a id="4452" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="4456" href="Data.Nat.Primality.html#4456" class="Bound">d≢p</a>  <a id="4461" class="Symbol">=</a> <a id="4463" href="Relation.Nullary.Negation.Core.html#778" class="Function">contradiction</a> <a id="4477" class="Symbol">(</a><a id="4478" href="Data.Nat.GCD.html#6635" class="Function">GCD.gcd∣n</a> <a id="4488" class="Bound">g</a><a id="4489" class="Symbol">)</a> <a id="4491" class="Symbol">(</a><a id="4492" href="Data.Nat.Primality.html#3159" class="Bound">p-prime</a> <a id="4500" class="Symbol">(</a><a id="4501" href="Data.Nat.Base.html#1529" class="InductiveConstructor">s≤s</a> <a id="4505" class="Symbol">(</a><a id="4506" href="Data.Nat.Base.html#1529" class="InductiveConstructor">s≤s</a> <a id="4510" href="Data.Nat.Base.html#1487" class="InductiveConstructor">z≤n</a><a id="4513" class="Symbol">))</a> <a id="4516" href="Data.Nat.Primality.html#4531" class="Function">d&lt;p</a><a id="4519" class="Symbol">)</a>
    <a id="4525" class="Keyword">where</a> <a id="4531" href="Data.Nat.Primality.html#4531" class="Function">d&lt;p</a> <a id="4535" class="Symbol">=</a> <a id="4537" href="Function.Base.html#1629" class="Function">flip</a> <a id="4542" href="Data.Nat.Properties.html#8908" class="Function">≤∧≢⇒&lt;</a> <a id="4548" href="Data.Nat.Primality.html#4456" class="Bound">d≢p</a> <a id="4552" class="Symbol">(</a><a id="4553" href="Data.Nat.Divisibility.html#1813" class="Function">∣⇒≤</a> <a id="4557" class="Symbol">(</a><a id="4558" href="Data.Nat.GCD.html#6635" class="Function">GCD.gcd∣n</a> <a id="4568" class="Bound">g</a><a id="4569" class="Symbol">))</a>

<a id="4573" class="Keyword">private</a>

  <a id="4584" class="Comment">-- Example: 2 is prime.</a>
  <a id="2-is-prime"></a><a id="4610" href="Data.Nat.Primality.html#4610" class="Function">2-is-prime</a> <a id="4621" class="Symbol">:</a> <a id="4623" href="Data.Nat.Primality.html#1279" class="Function">Prime</a> <a id="4629" class="Number">2</a>
  <a id="4633" href="Data.Nat.Primality.html#4610" class="Function">2-is-prime</a> <a id="4644" class="Symbol">=</a> <a id="4646" href="Relation.Nullary.Decidable.Core.html#2352" class="Function">from-yes</a> <a id="4655" class="Symbol">(</a><a id="4656" href="Data.Nat.Primality.html#1717" class="Function">prime?</a> <a id="4663" class="Number">2</a><a id="4664" class="Symbol">)</a>


  <a id="4670" class="Comment">-- Example: 6 is composite</a>
  <a id="6-is-composite"></a><a id="4699" href="Data.Nat.Primality.html#4699" class="Function">6-is-composite</a> <a id="4714" class="Symbol">:</a> <a id="4716" href="Data.Nat.Primality.html#1153" class="Function">Composite</a> <a id="4726" class="Number">6</a>
  <a id="4730" href="Data.Nat.Primality.html#4699" class="Function">6-is-composite</a> <a id="4745" class="Symbol">=</a> <a id="4747" href="Relation.Nullary.Decidable.Core.html#2352" class="Function">from-yes</a> <a id="4756" class="Symbol">(</a><a id="4757" href="Data.Nat.Primality.html#1450" class="Function">composite?</a> <a id="4768" class="Number">6</a><a id="4769" class="Symbol">)</a>

</pre></body></html>