<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>internal-library</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Level.html" class="Module">Level</a>
<a id="19" class="Keyword">open</a> <a id="24" class="Keyword">import</a> <a id="31" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="40" class="Keyword">hiding</a> <a id="47" class="Symbol">(</a><a id="48" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="51" class="Symbol">;</a> <a id="53" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="56" class="Symbol">;</a> <a id="58" href="Data.Nat.Properties.html#2529" class="Function Operator">_≟_</a><a id="61" class="Symbol">;</a> <a id="63" href="Data.Nat.Base.html#2475" class="Function">NonZero</a><a id="70" class="Symbol">)</a> <a id="72" class="Keyword">renaming</a> <a id="81" class="Symbol">(</a><a id="82" href="Data.Nat.Base.html#2880" class="Function">pred</a> <a id="87" class="Symbol">to</a> <a id="90" class="Function">predn</a><a id="95" class="Symbol">)</a>
<a id="97" class="Keyword">open</a> <a id="102" class="Keyword">import</a> <a id="109" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="123" class="Symbol">as</a> <a id="126" class="Module">ℚ</a>
  <a id="130" class="Keyword">renaming</a> <a id="139" class="Symbol">(</a><a id="140" href="Data.Rational.Base.html#6099" class="Function Operator">_+_</a> <a id="144" class="Symbol">to</a> <a id="147" class="Function Operator">_+q_</a><a id="151" class="Symbol">;</a> <a id="153" href="Data.Rational.Base.html#6190" class="Function Operator">_*_</a> <a id="157" class="Symbol">to</a> <a id="160" class="Function Operator">_*q_</a><a id="164" class="Symbol">;</a> <a id="166" href="Data.Rational.Base.html#4102" class="Function Operator">_/_</a> <a id="170" class="Symbol">to</a> <a id="173" class="Function Operator">_/q_</a><a id="177" class="Symbol">)</a>
  <a id="181" class="Keyword">hiding</a> <a id="188" class="Symbol">(</a><a id="189" href="Data.Rational.Properties.html#3468" class="Function Operator">_≟_</a><a id="192" class="Symbol">;</a> <a id="194" href="Data.Rational.Base.html#6568" class="Function Operator">_÷_</a><a id="197" class="Symbol">;</a> <a id="199" href="Data.Rational.Base.html#6360" class="Function Operator">1/_</a><a id="202" class="Symbol">)</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Data.Integer.html" class="Module">Data.Integer</a>
  <a id="231" class="Keyword">renaming</a> <a id="240" class="Symbol">(</a><a id="241" href="Data.Integer.Base.html#4844" class="Function Operator">_+_</a> <a id="245" class="Symbol">to</a> <a id="248" class="Function Operator">_+z_</a><a id="252" class="Symbol">;</a> <a id="254" href="Data.Integer.Base.html#5169" class="Function Operator">_*_</a> <a id="258" class="Symbol">to</a> <a id="261" class="Function Operator">_*z_</a><a id="265" class="Symbol">;</a> <a id="267" href="Data.Integer.Base.html#5023" class="Function Operator">_-_</a> <a id="271" class="Symbol">to</a> <a id="274" class="Function Operator">_-z_</a><a id="278" class="Symbol">)</a>
  <a id="282" class="Keyword">hiding</a> <a id="289" class="Symbol">(</a><a id="290" href="Data.Integer.Properties.html#2102" class="Function Operator">_≟_</a><a id="293" class="Symbol">)</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Data.Nat.Coprimality.html" class="Module">Data.Nat.Coprimality</a> <a id="350" class="Symbol">as</a> <a id="353" class="Module">C</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Data.List.html" class="Module">Data.List</a> <a id="377" class="Keyword">renaming</a> <a id="386" class="Symbol">(</a><a id="387" href="Data.List.Base.html#1544" class="Function">map</a> <a id="391" class="Symbol">to</a> <a id="394" class="Function">mapl</a><a id="398" class="Symbol">)</a>

<a id="401" class="Keyword">private</a> <a id="409" class="Keyword">variable</a>
  <a id="420" href="internal-library.html#420" class="Generalizable">ℓ</a> <a id="422" href="internal-library.html#422" class="Generalizable">ℓ&#39;</a> <a id="425" class="Symbol">:</a> <a id="427" href="Agda.Primitive.html#597" class="Postulate">Level</a>

<a id="Op2"></a><a id="434" href="internal-library.html#434" class="Function">Op2</a> <a id="438" class="Symbol">:</a> <a id="440" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="444" href="internal-library.html#420" class="Generalizable">ℓ</a> <a id="446" class="Symbol">→</a> <a id="448" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="452" href="internal-library.html#422" class="Generalizable">ℓ&#39;</a> <a id="455" class="Symbol">→</a> <a id="457" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="461" class="Symbol">_</a>
<a id="463" href="internal-library.html#434" class="Function">Op2</a> <a id="467" href="internal-library.html#467" class="Bound">A</a> <a id="469" href="internal-library.html#469" class="Bound">B</a> <a id="471" class="Symbol">=</a> <a id="473" href="internal-library.html#467" class="Bound">A</a> <a id="475" class="Symbol">→</a> <a id="477" href="internal-library.html#467" class="Bound">A</a> <a id="479" class="Symbol">→</a> <a id="481" href="internal-library.html#469" class="Bound">B</a>

<a id="_&lt;?&gt;_"></a><a id="484" href="internal-library.html#484" class="Function Operator">_&lt;?&gt;_</a> <a id="490" class="Symbol">:</a>  <a id="493" href="internal-library.html#434" class="Function">Op2</a> <a id="497" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="501" class="Symbol">(</a><a id="502" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="507" class="Symbol">→</a> <a id="509" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="512" class="Symbol">)</a>
<a id="514" class="Symbol">(</a><a id="515" href="internal-library.html#515" class="Bound">x</a> <a id="517" href="internal-library.html#484" class="Function Operator">&lt;?&gt;</a> <a id="521" href="internal-library.html#521" class="Bound">y</a><a id="522" class="Symbol">)</a> <a id="524" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="530" class="Symbol">=</a> <a id="532" href="internal-library.html#515" class="Bound">x</a>
<a id="534" class="Symbol">(</a><a id="535" href="internal-library.html#535" class="Bound">x</a> <a id="537" href="internal-library.html#484" class="Function Operator">&lt;?&gt;</a> <a id="541" href="internal-library.html#541" class="Bound">y</a><a id="542" class="Symbol">)</a> <a id="544" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="550" class="Symbol">=</a> <a id="552" href="internal-library.html#541" class="Bound">y</a>

<a id="1/_"></a><a id="555" href="internal-library.html#555" class="Function Operator">1/_</a> <a id="559" class="Symbol">:</a> <a id="561" class="Symbol">(</a><a id="562" href="internal-library.html#562" class="Bound">p</a> <a id="564" class="Symbol">:</a> <a id="566" href="Data.Rational.Base.html#1883" class="Record">ℚ</a><a id="567" class="Symbol">)</a> <a id="569" class="Symbol">→</a> <a id="571" class="Symbol">.{{</a><a id="574" href="internal-library.html#574" class="Bound">_</a> <a id="576" class="Symbol">:</a> <a id="578" href="Data.Rational.Base.html#4738" class="Function">ℚ.NonZero</a> <a id="588" href="internal-library.html#562" class="Bound">p</a><a id="589" class="Symbol">}}</a> <a id="592" class="Symbol">→</a> <a id="594" href="Data.Rational.Base.html#1883" class="Record">ℚ</a>
<a id="596" href="internal-library.html#555" class="Function Operator">1/</a> <a id="599" href="Data.Rational.Base.html#1911" class="InductiveConstructor">mkℚ</a> <a id="603" href="Data.Integer.Base.html#1467" class="InductiveConstructor Operator">+[1+</a> <a id="608" href="internal-library.html#608" class="Bound">n</a> <a id="610" href="Data.Integer.Base.html#1467" class="InductiveConstructor Operator">]</a> <a id="612" href="internal-library.html#612" class="Bound">d</a> <a id="614" href="internal-library.html#614" class="Bound">prf</a> <a id="618" class="Symbol">=</a> <a id="620" href="Data.Rational.Base.html#1911" class="InductiveConstructor">mkℚ</a> <a id="624" href="Data.Integer.Base.html#1467" class="InductiveConstructor Operator">+[1+</a> <a id="629" href="internal-library.html#612" class="Bound">d</a> <a id="631" href="Data.Integer.Base.html#1467" class="InductiveConstructor Operator">]</a> <a id="633" href="internal-library.html#608" class="Bound">n</a> <a id="635" class="Symbol">(</a><a id="636" href="Data.Nat.Coprimality.html#2221" class="Function">C.sym</a> <a id="642" href="internal-library.html#614" class="Bound">prf</a><a id="645" class="Symbol">)</a>
<a id="647" href="internal-library.html#555" class="Function Operator">1/</a> <a id="650" href="Data.Rational.Base.html#1911" class="InductiveConstructor">mkℚ</a> <a id="654" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">-[1+</a> <a id="659" href="internal-library.html#659" class="Bound">n</a> <a id="661" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">]</a> <a id="663" href="internal-library.html#663" class="Bound">d</a> <a id="665" href="internal-library.html#665" class="Bound">prf</a> <a id="669" class="Symbol">=</a> <a id="671" href="Data.Rational.Base.html#1911" class="InductiveConstructor">mkℚ</a> <a id="675" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">-[1+</a> <a id="680" href="internal-library.html#663" class="Bound">d</a> <a id="682" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">]</a> <a id="684" href="internal-library.html#659" class="Bound">n</a> <a id="686" class="Symbol">(</a><a id="687" href="Data.Nat.Coprimality.html#2221" class="Function">C.sym</a> <a id="693" href="internal-library.html#665" class="Bound">prf</a><a id="696" class="Symbol">)</a>

<a id="_÷_"></a><a id="699" href="internal-library.html#699" class="Function Operator">_÷_</a> <a id="703" class="Symbol">:</a> <a id="705" class="Symbol">(</a><a id="706" href="internal-library.html#706" class="Bound">p</a> <a id="708" href="internal-library.html#708" class="Bound">q</a> <a id="710" class="Symbol">:</a> <a id="712" href="Data.Rational.Base.html#1883" class="Record">ℚ</a><a id="713" class="Symbol">)</a> <a id="715" class="Symbol">→</a> <a id="717" class="Symbol">.{{</a><a id="720" href="internal-library.html#720" class="Bound">_</a> <a id="722" class="Symbol">:</a> <a id="724" href="Data.Rational.Base.html#4738" class="Function">ℚ.NonZero</a> <a id="734" href="internal-library.html#708" class="Bound">q</a><a id="735" class="Symbol">}}</a> <a id="738" class="Symbol">→</a> <a id="740" href="Data.Rational.Base.html#1883" class="Record">ℚ</a>
<a id="742" href="internal-library.html#742" class="Bound">p</a> <a id="744" href="internal-library.html#699" class="Function Operator">÷</a> <a id="746" href="internal-library.html#746" class="Bound">q</a> <a id="748" class="Symbol">=</a> <a id="750" href="internal-library.html#742" class="Bound">p</a> <a id="752" href="internal-library.html#160" class="Function Operator">*q</a> <a id="755" class="Symbol">(</a><a id="756" href="internal-library.html#555" class="Function Operator">1/</a> <a id="759" href="internal-library.html#746" class="Bound">q</a><a id="760" class="Symbol">)</a>

<a id="sumℤ"></a><a id="763" href="internal-library.html#763" class="Function">sumℤ</a> <a id="768" class="Symbol">:</a> <a id="770" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="775" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="777" class="Symbol">→</a> <a id="779" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
<a id="781" href="internal-library.html#763" class="Function">sumℤ</a> <a id="786" class="Symbol">=</a> <a id="788" href="Data.List.Base.html#4192" class="Function">foldr</a> <a id="794" href="internal-library.html#248" class="Function Operator">_+z_</a> <a id="799" class="Symbol">(</a><a id="800" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="802" class="Number">0</a><a id="803" class="Symbol">)</a>

<a id="sumℚ"></a><a id="806" href="internal-library.html#806" class="Function">sumℚ</a> <a id="811" class="Symbol">:</a> <a id="813" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="818" href="Data.Rational.Base.html#1883" class="Record">ℚ</a> <a id="820" class="Symbol">→</a> <a id="822" href="Data.Rational.Base.html#1883" class="Record">ℚ</a>
<a id="824" href="internal-library.html#806" class="Function">sumℚ</a> <a id="829" class="Symbol">=</a> <a id="831" href="Data.List.Base.html#4192" class="Function">foldr</a> <a id="837" href="internal-library.html#147" class="Function Operator">_+q_</a> <a id="842" href="Data.Rational.Base.html#4565" class="Function">0ℚ</a>

<a id="prodℚ"></a><a id="846" href="internal-library.html#846" class="Function">prodℚ</a> <a id="852" class="Symbol">:</a> <a id="854" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="859" href="Data.Rational.Base.html#1883" class="Record">ℚ</a> <a id="861" class="Symbol">→</a> <a id="863" href="Data.Rational.Base.html#1883" class="Record">ℚ</a>
<a id="865" href="internal-library.html#846" class="Function">prodℚ</a> <a id="871" class="Symbol">=</a> <a id="873" href="Data.List.Base.html#4192" class="Function">foldr</a> <a id="879" href="internal-library.html#160" class="Function Operator">_*q_</a> <a id="884" href="Data.Rational.Base.html#4586" class="Function">1ℚ</a>

<a id="888" class="Comment">-- nonZero-* : ∀ {x y} → ℚ.NonZero x → ℚ.NonZero y → ℚ.NonZero (x *q y)</a>
<a id="960" class="Comment">-- nonZero-* {x} {y} p q = {!!}</a>

<a id="_**_"></a><a id="993" href="internal-library.html#993" class="Function Operator">_**_</a> <a id="998" class="Symbol">:</a> <a id="1000" class="Symbol">(</a><a id="1001" href="internal-library.html#1001" class="Bound">x</a> <a id="1003" class="Symbol">:</a> <a id="1005" href="Data.Rational.Base.html#1883" class="Record">ℚ</a><a id="1006" class="Symbol">)</a> <a id="1008" class="Symbol">→</a> <a id="1010" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="1012" class="Symbol">→</a> <a id="1014" class="Symbol">⦃</a> <a id="1016" href="internal-library.html#1016" class="Bound">_</a> <a id="1018" class="Symbol">:</a> <a id="1020" href="Data.Rational.Base.html#4738" class="Function">ℚ.NonZero</a> <a id="1030" href="internal-library.html#1001" class="Bound">x</a> <a id="1032" class="Symbol">⦄</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="Data.Rational.Base.html#1883" class="Record">ℚ</a>
<a id="1038" href="internal-library.html#1038" class="Bound">x</a> <a id="1040" href="internal-library.html#993" class="Function Operator">**</a> <a id="1043" class="Symbol">(</a><a id="1044" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+_</a> <a id="1047" class="Number">0</a><a id="1048" class="Symbol">)</a> <a id="1050" class="Symbol">=</a> <a id="1052" href="Data.Rational.Base.html#4586" class="Function">1ℚ</a>
<a id="1055" href="internal-library.html#1055" class="Bound">x</a> <a id="1057" href="internal-library.html#993" class="Function Operator">**</a> <a id="1060" href="Data.Integer.Base.html#1467" class="InductiveConstructor Operator">+[1+</a> <a id="1065" href="internal-library.html#1065" class="Bound">n</a> <a id="1067" href="Data.Integer.Base.html#1467" class="InductiveConstructor Operator">]</a> <a id="1069" class="Symbol">=</a> <a id="1071" href="internal-library.html#1055" class="Bound">x</a> <a id="1073" href="internal-library.html#160" class="Function Operator">*q</a> <a id="1076" class="Symbol">(</a><a id="1077" href="internal-library.html#1055" class="Bound">x</a> <a id="1079" href="internal-library.html#993" class="Function Operator">**</a> <a id="1082" class="Symbol">(</a><a id="1083" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="1085" href="internal-library.html#1065" class="Bound">n</a><a id="1086" class="Symbol">))</a>
<a id="1089" href="internal-library.html#1089" class="Bound">x</a> <a id="1091" href="internal-library.html#993" class="Function Operator">**</a> <a id="1094" class="Symbol">(</a><a id="1095" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">-[1+</a> <a id="1100" class="Number">0</a> <a id="1102" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">]</a><a id="1103" class="Symbol">)</a> <a id="1105" class="Symbol">=</a> <a id="1107" href="internal-library.html#555" class="Function Operator">1/</a> <a id="1110" href="internal-library.html#1089" class="Bound">x</a>
<a id="1112" href="internal-library.html#1112" class="Bound">x</a> <a id="1114" href="internal-library.html#993" class="Function Operator">**</a> <a id="1117" class="Symbol">(</a><a id="1118" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">-[1+</a> <a id="1123" class="Symbol">(</a><a id="1124" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1128" href="internal-library.html#1128" class="Bound">n</a><a id="1129" class="Symbol">)</a> <a id="1131" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">]</a><a id="1132" class="Symbol">)</a> <a id="1134" class="Symbol">=</a> <a id="1136" class="Symbol">(</a><a id="1137" href="internal-library.html#555" class="Function Operator">1/</a> <a id="1140" href="internal-library.html#1112" class="Bound">x</a><a id="1141" class="Symbol">)</a> <a id="1143" href="internal-library.html#160" class="Function Operator">*q</a> <a id="1146" class="Symbol">(</a><a id="1147" href="internal-library.html#1112" class="Bound">x</a> <a id="1149" href="internal-library.html#993" class="Function Operator">**</a> <a id="1152" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">-[1+</a> <a id="1157" href="internal-library.html#1128" class="Bound">n</a> <a id="1159" href="Agda.Builtin.Int.html#291" class="InductiveConstructor Operator">]</a><a id="1160" class="Symbol">)</a>
</pre></body></html>