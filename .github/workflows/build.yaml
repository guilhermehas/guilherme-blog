name: Build
on: [push]
jobs:
   deploy:
      runs-on: ubuntu-latest
      steps:
        - uses: cachix/install-nix-action@v12
          with:
            install_url: https://github.com/numtide/nix-flakes-installer/releases/download/nix-3.0pre20201007_5257a25/install
        - name: Nix Setup
          run: |
            touch ~/.config/nix/nix.conf
            echo ' 
              experimental-features = nix-command flakes
              extra-trusted-substituters = https://cache.nixos.org/ https://hydra.iohk.io
              extra-trusted-public-keys = cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY= hydra.iohk.io:f/Ea+s+dFdN+3Y/G+FDgSq+a5NEWhJGzdjvKNGv0/EQ=' > ~/.config/nix/nix.conf
        - name: Build
          run: nix build -v --print-build-logs
        - uses: peaceiris/actions-gh-pages@v3
          with:
            github_token: ${{ secrets.GITHUBTOKEN }}
            publish_dir: ./result
            publish_branch: gh-pages